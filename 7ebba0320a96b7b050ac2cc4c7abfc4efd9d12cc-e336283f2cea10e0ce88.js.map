{"version":3,"sources":["webpack:///./src/components/content/PhotoswipeWrapper.jsx","webpack:///./node_modules/photoswipe/dist/photoswipe-ui-default.js","webpack:///./node_modules/photoswipe/dist/photoswipe.js"],"names":["PhotoswipeWrapper","React","createElement","className","id","tabIndex","role","aria-hidden","type","title","Icon","icon","pswp","framework","_fullscrenAPI","_controls","_captionContainer","_fakeCaptionContainer","_indexIndicator","_shareButton","_shareModal","_initalCloseOnScrollValue","_isIdle","_listen","_loadingIndicator","_loadingIndicatorHidden","_loadingIndicatorTimeout","_galleryHasOneSlide","_options","_blockControlsTap","_idleInterval","_idleTimer","ui","this","_overlayUIUpdated","_controlsVisible","_shareModalHidden","_defaultUIOptions","barsSize","top","bottom","closeElClasses","timeToIdle","timeToIdleOutside","loadingIndicatorDelay","addCaptionHTMLFn","item","captionEl","children","innerHTML","closeEl","fullscreenEl","zoomEl","shareEl","counterEl","arrowEl","preloaderEl","tapToClose","tapToToggleControls","clickToCloseNonZoomable","shareButtons","label","url","download","getImageURLForShare","currItem","src","getPageURLForShare","window","location","href","getTextForShare","indexIndicatorSep","fitControlsWidth","_onControlsTap","e","event","mouseUsed","_onIdleMouseMove","uiElement","found","clickedClass","target","srcElement","getAttribute","i","_uiElements","length","onTap","indexOf","name","stopPropagation","tapDelay","features","isOldAndroid","setTimeout","_togglePswpClass","el","cName","add","_countNumItems","hasOneSlide","getNumItemsFn","_toggleShareModalClass","_toggleShareModal","removeClass","addClass","_updateShareURLs","_openWindowPopup","shout","hasAttribute","open","screen","Math","round","width","shareButtonData","image_url","page_url","share_text","shareButtonOut","replace","encodeURIComponent","parseShareButtonOut","onclick","_hasCloseClass","hasClass","_idleIncrement","clearTimeout","setIdle","_onMouseLeaveWindow","from","relatedTarget","toElement","nodeName","_toggleLoadingIndicator","hide","_applyNavBarGaps","gap","vGap","likelyTouchDevice","bars","createEl","appendChild","insertBefore","captionSize","clientHeight","parseInt","option","onInit","toggleDesktopZoom","close","prev","next","isFullscreen","exit","enter","init","pinchControlsHidden","extend","options","getChildByClass","scrollWrap","listen","now","hideControls","showControls","update","point","initialZoomLevel","getZoomLevel","zoomTo","getDoubleTapZoom","isDown","preventObj","t","test","tagName","prevent","bind","onGlobalTap","onMouseOver","clearInterval","unbind","document","eventK","updateFullscreen","hideAnimationDuration","removeChild","showAnimationDuration","classAttr","loopThroughChildElements","sChildren","l","a","topBar","_setupUIElements","setInterval","getFullscreenAPI","template","loading","allowProgressiveImg","img","naturalWidth","index","isIdle","updateIndexIndicator","setScrollOffset","getScrollY","getCurrentIndex","detail","pointerType","fitRatio","releasePoint","supportsFullscreen","d","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","api","dE","documentElement","tF","requestFullscreen","enterK","exitK","elementK","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","closeOnScroll","Element","ALLOW_KEYBOARD_INPUT","UiClass","items","listener","methodName","split","isArray","obj","Array","classes","tag","yOffset","pageYOffset","undefined","scrollTop","reg","RegExp","parentEl","childClassName","node","firstChild","nextSibling","arraySearch","array","value","key","o1","o2","preventOverwrite","prop","hasOwnProperty","easing","sine","out","k","sin","PI","inOut","cos","cubic","detectFeatures","helperStyle","style","vendor","oldIE","all","addEventListener","touch","requestAnimationFrame","raf","caf","cancelAnimationFrame","pointerEvent","PointerEvent","navigator","msPointerEnabled","ua","userAgent","platform","v","appVersion","match","isOldIOSPhone","androidversion","parseFloat","androidVersion","isMobileOpera","styleCheckItem","styleName","styleChecks","vendors","charAt","toUpperCase","slice","toLowerCase","lastTime","fn","currTime","Date","getTime","timeToCall","max","svg","createElementNS","createSVGRect","evName","_handleEv","handleEvent","call","self","allowPanToNext","spacing","bgOpacity","loop","pinchToClose","closeOnVerticalDrag","verticalDragRange","showHideOpacity","focus","escKey","arrowKeys","mainScrollEndFriction","panEndFriction","isClickableElement","isMouseClick","maxSpreadZoom","modal","scaleMode","_isOpen","_isDestroying","_closedByScroll","_currentItemIndex","_containerStyle","_containerShiftIndex","_upMoveEvents","_downEvents","_globalEventHandlers","_currZoomLevel","_startZoomLevel","_translatePrefix","_translateSufix","_updateSizeInterval","_itemsNeedUpdate","_itemHolders","_prevItemIndex","_dragStartEvent","_dragMoveEvent","_dragEndEvent","_dragCancelEvent","_transformKey","_pointerEventEnabled","_likelyTouchDevice","_requestAF","_cancelAF","_initalClassName","_initalWindowScrollY","_oldIE","_currentWindowScrollY","_features","_orientationChangeTimeout","_gestureStartTime","_gestureCheckSpeedTime","_releaseAnimData","_isZoomingIn","_verticalDragInitiated","_oldAndroidTouchEndTimeout","_isDragging","_isMultitouch","_zoomStarted","_moved","_dragAnimFrame","_mainScrollShifted","_currentPoints","_isZooming","_startPointsDistance","_currPanBounds","_currZoomElementStyle","_mainScrollAnimating","_direction","_isFirstMove","_opacityChanged","_bgOpacity","_wasOverInitialZoom","_tempCounter","_currPanDist","x","y","_startPanOffset","_panOffset","_viewportSize","_currPositionIndex","_offset","_slideSize","_indexDiff","_isFixedPosition","_modules","_windowVisibleSize","_renderMaxResolution","_registerModule","module","publicMethods","push","_getLoopedId","numSlides","_getNumItems","_listeners","_shout","listeners","args","prototype","arguments","shift","apply","_getCurrentTime","_applyBgOpacity","opacity","bg","_applyZoomTransform","styleObj","zoom","_applyCurrentZoomPan","allowRenderResolution","_setImageSize","_applyZoomPanToItem","container","initialPosition","_setTranslateX","elStyle","_moveMainScroll","dragging","newSlideIndexOffset","delta","_mainScrollPos","_calculatePanOffset","axis","zoomLevel","m","_midZoomPoint","_equalizePoints","p1","p2","_roundPoint","p","_mouseMoveTimeout","_onFirstMouseMove","_calculatePanBounds","bounds","_calculateItemSize","_getMinZoomLevel","_getMaxZoomLevel","w","_modifyDestPanOffset","destPanBounds","destPanOffset","destZoomLevel","min","_onKeyDown","keydownAction","keyCode","ctrlKey","altKey","shiftKey","metaKey","preventDefault","returnValue","_onGlobalClick","_updatePageScrollOffset","_animations","_numAnimations","_stopAnimation","_registerStartAnimation","_stopAllAnimations","_animateProp","b","endProp","easingFn","onUpdate","onComplete","startAnimTime","animloop","viewportSize","isMainScrollAnimating","isDragging","isZooming","applyZoomPan","panX","panY","transform","itemHolders","wrap","display","allow3dTransform","perspective","left","zoomRatio","s","h","height","_setupTransforms","resize","updateSize","orientationchange","clientWidth","scroll","keydown","click","oldPhone","animationName","isNaN","_getItemAt","setAttribute","position","rootClasses","mainClass","setContent","updateCurrItem","_showOrHide","destroy","_showOrHideTimeout","_stopDragUpdateLoop","panTo","force","goTo","diff","updateCurrZoomItem","emulateSetContent","zoomElement","center","invalidateCurrItems","needsUpdate","beforeAnimation","tempHolder","diffAbs","abs","NUM_HOLDERS","pop","unshift","prevItem","windowScrollY","innerWidth","innerHeight","holder","hIndex","cleanSlide","centerPoint","speed","updateFn","initialPanOffset","_currPoint","_startPoint","_currPointers","_startMainScrollPos","_posPoints","_tempPoint","_currZoomedItemIndex","_centerPoint","_lastReleaseTime","_currCenterPoint","_calculatePointsDistance","sqrt","_dragUpdateLoop","_renderMovement","_closestElement","parentNode","_preventObj","_preventDefaultEventBehaviour","_convertTouchToPoint","pageX","pageY","identifier","_findCenterOfPoints","pCenter","_calculateVerticalDragOpacityRatio","_ePoint1","_ePoint2","_tempPointsArr","_getTouchPoints","forEach","touches","_panOrMoveMainScroll","panFriction","startOverDiff","newPanPos","newMainScrollPos","newOffset","dir","newMainScrollPosition","mainScrollDiff","_onDragStart","button","_initialZoomRunning","pointerIndex","pointerId","startPointsList","numPoints","_onDragMove","touchesList","_isEqualPoints","pointsDistance","_calculateZoomLevel","zoomFriction","minZoomLevel","maxZoomLevel","percent","opacityRatio","time","o","_pushPosPoint","_onDragRelease","splice","4","2","3","gestureType","touchList","changedTouches","releaseTimeDiff","_initDragReleaseAnimationData","calculateSwipeSpeed","initalPanY","initialBgOpacity","_finishSwipeMainScrollGesture","_completePanGesture","_completeZoomGesture","lastFlickDuration","tempReleasePos","lastFlickOffset","lastFlickDist","lastFlickSpeed","slowDownRatio","slowDownRatioReverse","speedDecelerationRatio","speedDecelerationRatioAbs","distanceOffset","backAnimDestination","backAnimStarted","calculateOverBoundsAnimOffset","pos","calculateAnimOffset","timeDiff","panAnimLoop","zoomPan","lastNow","animData","itemChanged","itemsDiff","nextCircle","totalShiftDist","isFastLastFlick","finishAnimDuration","animateToX","animateToDist","touchesDistance","initialOpacity","initGestures","addEventNames","pref","down","move","up","cancel","maxTouchPoints","msMaxTouchPoints","mousedown","mousemove","mouseup","_items","_initialContentSet","completeFn","thumbBounds","initialLayout","getThumbBoundsFn","closeWithRaf","fadeEverything","duration","removeAttribute","loadError","miniImg","webkitBackfaceVisibility","initalBgOpacity","_tempPanAreaSize","_imagesToAppendPool","_controllerDefaultOptions","errorMsg","forceProgressiveLoading","preload","isInitial","hRatio","vRatio","realPanElementW","realPanElementH","_calculateSingleItemPanBounds","_appendImage","baseDiv","preventAnimation","keepPlaceholder","imageAppended","loaded","placeholder","_preloadImage","loadComplete","onload","onerror","_checkForError","cleanUp","maxRes","lastChild","_appendImagesPool","poolItem","clearPlaceholder","lazyLoadItem","initController","getItemAt","isNext","preloadBefore","preloadAfter","preloader","html","placeholderClassName","msrc","tapTimer","_wheelDelta","tapReleasePoint","_dispatchTapEvent","origEvent","createEvent","eDetail","initCustomEvent","dispatchEvent","initTap","onTapStart","onTapRelease","touch0","touch1","p0","initDesktopZoom","setupDesktopZoom","events","handleMouseWheel","mouseZoomedIn","hasDraggingClass","updateZoomable","removeDraggingClass","deltaY","deltaMode","deltaX","wheelDeltaX","wheelDeltaY","wheelDelta","newPanX","newPanY","doubleTapZoomLevel","zoomOut","_historyUpdateTimeout","_hashChangeTimeout","_hashAnimCheckTimeout","_hashChangedByScript","_hashChangedByHistory","_hashReseted","_initialHash","_historyChanged","_closedFromURL","_urlChangedOnce","_windowLoc","_supportsPushState","_historyDefaultOptions","history","galleryUID","_getHash","hash","substring","_cleanHistoryTimeouts","_parseItemIndexFromURL","params","vars","pair","galleryPIDs","searchfor","pid","_updateHash","newHash","newURL","initHistory","updateURL","onHashChange","returnToOriginal","back","pushState","pathname","search"],"mappings":"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","file":"7ebba0320a96b7b050ac2cc4c7abfc4efd9d12cc-e336283f2cea10e0ce88.js","sourcesContent":["import React from 'react';\n\nimport 'photoswipe/dist/photoswipe.css';\nimport 'photoswipe/dist/default-skin/default-skin.css';\n\nimport Icon from '../Icon';\n\n// Root element of PhotoSwipe. Must have class pswp.\nconst PhotoswipeWrapper = () => (\n  <div className=\"pswp\" id=\"pswp\" tabIndex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    {/* Background of PhotoSwipe.\n         It's a separate element as animating opacity is faster than rgba( */}\n    <div className=\"pswp__bg\" />\n    {/* Slides wrapper with overflow:hidden. */}\n    <div className=\"pswp__scroll-wrap\">\n      {/* Container that holds slides.\n            PhotoSwipe keeps only 3 of them in the DOM to save memory.\n            Don't modify these 3 pswp__item elements, data is added later on. */}\n      <div className=\"pswp__container\">\n        <div className=\"pswp__item\" />\n        <div className=\"pswp__item\" />\n        <div className=\"pswp__item\" />\n      </div>\n      {/* Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. */}\n      <div className=\"pswp__ui pswp__ui--hidden\">\n        <div className=\"pswp__top-bar\">\n          {/* Controls are self-explanatory. Order can be changed. */}\n          <div className=\"pswp__counter\" />\n          <button type=\"button\" className=\"pswp__button pswp__button--close\" title=\"Close (Esc)\">\n            <Icon icon=\"close\" />\n          </button>\n          <button type=\"button\" className=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\">\n            <Icon icon=\"zoom\" />\n          </button>\n          <button type=\"button\" className=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\">\n            <Icon icon=\"fullscreen\" />\n          </button>\n          {/* Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR */}\n          {/* element will get class pswp__preloader--active when preloader is running */}\n          <div className=\"pswp__preloader\">\n            <div className=\"pswp__preloader__icn\">\n              <div className=\"pswp__preloader__cut\">\n                <div className=\"pswp__preloader__donut\" />\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\">\n          <div className=\"pswp__share-tooltip\" />\n        </div>\n        <button\n          type=\"button\"\n          className=\"pswp__button pswp__button--arrow--left\"\n          title=\"Previous (arrow left)\"\n        >\n          <Icon icon=\"left\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"pswp__button pswp__button--arrow--right\"\n          title=\"Next (arrow right)\"\n        >\n          <Icon icon=\"right\" />\n        </button>\n        <div className=\"pswp__caption\">\n          <div className=\"pswp__caption__center\" />\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nexport default PhotoswipeWrapper;\n","/*! PhotoSwipe Default UI - 4.1.3 - 2019-01-08\n* http://photoswipe.com\n* Copyright (c) 2019 Dmitry Semenov; */\n/**\n*\n* UI on top of main sliding area (caption, arrows, close button, etc.).\n* Built just using public methods/properties of PhotoSwipe.\n* \n*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.PhotoSwipeUI_Default = factory();\n  }\n})(this, function () {\n  'use strict';\n\n  var PhotoSwipeUI_Default = function (pswp, framework) {\n    var ui = this;\n    var _overlayUIUpdated = false,\n      _controlsVisible = true,\n      _fullscrenAPI,\n      _controls,\n      _captionContainer,\n      _fakeCaptionContainer,\n      _indexIndicator,\n      _shareButton,\n      _shareModal,\n      _shareModalHidden = true,\n      _initalCloseOnScrollValue,\n      _isIdle,\n      _listen,\n      _loadingIndicator,\n      _loadingIndicatorHidden,\n      _loadingIndicatorTimeout,\n      _galleryHasOneSlide,\n      _options,\n      _defaultUIOptions = {\n        barsSize: {\n          top: 44,\n          bottom: 'auto'\n        },\n        closeElClasses: ['item', 'caption', 'zoom-wrap', 'ui', 'top-bar'],\n        timeToIdle: 4000,\n        timeToIdleOutside: 1000,\n        loadingIndicatorDelay: 1000,\n        // 2s\n\n        addCaptionHTMLFn: function (item, captionEl /*, isFake */) {\n          if (!item.title) {\n            captionEl.children[0].innerHTML = '';\n            return false;\n          }\n          captionEl.children[0].innerHTML = item.title;\n          return true;\n        },\n        closeEl: true,\n        captionEl: true,\n        fullscreenEl: true,\n        zoomEl: true,\n        shareEl: true,\n        counterEl: true,\n        arrowEl: true,\n        preloaderEl: true,\n        tapToClose: false,\n        tapToToggleControls: true,\n        clickToCloseNonZoomable: true,\n        shareButtons: [{\n          id: 'facebook',\n          label: 'Share on Facebook',\n          url: 'https://www.facebook.com/sharer/sharer.php?u={{url}}'\n        }, {\n          id: 'twitter',\n          label: 'Tweet',\n          url: 'https://twitter.com/intent/tweet?text={{text}}&url={{url}}'\n        }, {\n          id: 'pinterest',\n          label: 'Pin it',\n          url: 'http://www.pinterest.com/pin/create/button/' + '?url={{url}}&media={{image_url}}&description={{text}}'\n        }, {\n          id: 'download',\n          label: 'Download image',\n          url: '{{raw_image_url}}',\n          download: true\n        }],\n        getImageURLForShare: function /* shareButtonData */\n        () {\n          return pswp.currItem.src || '';\n        },\n        getPageURLForShare: function /* shareButtonData */\n        () {\n          return window.location.href;\n        },\n        getTextForShare: function /* shareButtonData */\n        () {\n          return pswp.currItem.title || '';\n        },\n        indexIndicatorSep: ' / ',\n        fitControlsWidth: 1200\n      },\n      _blockControlsTap,\n      _blockControlsTapTimeout;\n    var _onControlsTap = function (e) {\n        if (_blockControlsTap) {\n          return true;\n        }\n        e = e || window.event;\n        if (_options.timeToIdle && _options.mouseUsed && !_isIdle) {\n          // reset idle timer\n          _onIdleMouseMove();\n        }\n        var target = e.target || e.srcElement,\n          uiElement,\n          clickedClass = target.getAttribute('class') || '',\n          found;\n        for (var i = 0; i < _uiElements.length; i++) {\n          uiElement = _uiElements[i];\n          if (uiElement.onTap && clickedClass.indexOf('pswp__' + uiElement.name) > -1) {\n            uiElement.onTap();\n            found = true;\n          }\n        }\n        if (found) {\n          if (e.stopPropagation) {\n            e.stopPropagation();\n          }\n          _blockControlsTap = true;\n\n          // Some versions of Android don't prevent ghost click event \n          // when preventDefault() was called on touchstart and/or touchend.\n          // \n          // This happens on v4.3, 4.2, 4.1, \n          // older versions strangely work correctly, \n          // but just in case we add delay on all of them)\t\n          var tapDelay = framework.features.isOldAndroid ? 600 : 30;\n          _blockControlsTapTimeout = setTimeout(function () {\n            _blockControlsTap = false;\n          }, tapDelay);\n        }\n      },\n      _fitControlsInViewport = function () {\n        return !pswp.likelyTouchDevice || _options.mouseUsed || screen.width > _options.fitControlsWidth;\n      },\n      _togglePswpClass = function (el, cName, add) {\n        framework[(add ? 'add' : 'remove') + 'Class'](el, 'pswp__' + cName);\n      },\n      // add class when there is just one item in the gallery\n      // (by default it hides left/right arrows and 1ofX counter)\n      _countNumItems = function () {\n        var hasOneSlide = _options.getNumItemsFn() === 1;\n        if (hasOneSlide !== _galleryHasOneSlide) {\n          _togglePswpClass(_controls, 'ui--one-slide', hasOneSlide);\n          _galleryHasOneSlide = hasOneSlide;\n        }\n      },\n      _toggleShareModalClass = function () {\n        _togglePswpClass(_shareModal, 'share-modal--hidden', _shareModalHidden);\n      },\n      _toggleShareModal = function () {\n        _shareModalHidden = !_shareModalHidden;\n        if (!_shareModalHidden) {\n          _toggleShareModalClass();\n          setTimeout(function () {\n            if (!_shareModalHidden) {\n              framework.addClass(_shareModal, 'pswp__share-modal--fade-in');\n            }\n          }, 30);\n        } else {\n          framework.removeClass(_shareModal, 'pswp__share-modal--fade-in');\n          setTimeout(function () {\n            if (_shareModalHidden) {\n              _toggleShareModalClass();\n            }\n          }, 300);\n        }\n        if (!_shareModalHidden) {\n          _updateShareURLs();\n        }\n        return false;\n      },\n      _openWindowPopup = function (e) {\n        e = e || window.event;\n        var target = e.target || e.srcElement;\n        pswp.shout('shareLinkClick', e, target);\n        if (!target.href) {\n          return false;\n        }\n        if (target.hasAttribute('download')) {\n          return true;\n        }\n        window.open(target.href, 'pswp_share', 'scrollbars=yes,resizable=yes,toolbar=no,' + 'location=yes,width=550,height=420,top=100,left=' + (window.screen ? Math.round(screen.width / 2 - 275) : 100));\n        if (!_shareModalHidden) {\n          _toggleShareModal();\n        }\n        return false;\n      },\n      _updateShareURLs = function () {\n        var shareButtonOut = '',\n          shareButtonData,\n          shareURL,\n          image_url,\n          page_url,\n          share_text;\n        for (var i = 0; i < _options.shareButtons.length; i++) {\n          shareButtonData = _options.shareButtons[i];\n          image_url = _options.getImageURLForShare(shareButtonData);\n          page_url = _options.getPageURLForShare(shareButtonData);\n          share_text = _options.getTextForShare(shareButtonData);\n          shareURL = shareButtonData.url.replace('{{url}}', encodeURIComponent(page_url)).replace('{{image_url}}', encodeURIComponent(image_url)).replace('{{raw_image_url}}', image_url).replace('{{text}}', encodeURIComponent(share_text));\n          shareButtonOut += '<a href=\"' + shareURL + '\" target=\"_blank\" ' + 'class=\"pswp__share--' + shareButtonData.id + '\"' + (shareButtonData.download ? 'download' : '') + '>' + shareButtonData.label + '</a>';\n          if (_options.parseShareButtonOut) {\n            shareButtonOut = _options.parseShareButtonOut(shareButtonData, shareButtonOut);\n          }\n        }\n        _shareModal.children[0].innerHTML = shareButtonOut;\n        _shareModal.children[0].onclick = _openWindowPopup;\n      },\n      _hasCloseClass = function (target) {\n        for (var i = 0; i < _options.closeElClasses.length; i++) {\n          if (framework.hasClass(target, 'pswp__' + _options.closeElClasses[i])) {\n            return true;\n          }\n        }\n      },\n      _idleInterval,\n      _idleTimer,\n      _idleIncrement = 0,\n      _onIdleMouseMove = function () {\n        clearTimeout(_idleTimer);\n        _idleIncrement = 0;\n        if (_isIdle) {\n          ui.setIdle(false);\n        }\n      },\n      _onMouseLeaveWindow = function (e) {\n        e = e ? e : window.event;\n        var from = e.relatedTarget || e.toElement;\n        if (!from || from.nodeName === 'HTML') {\n          clearTimeout(_idleTimer);\n          _idleTimer = setTimeout(function () {\n            ui.setIdle(true);\n          }, _options.timeToIdleOutside);\n        }\n      },\n      _setupFullscreenAPI = function () {\n        if (_options.fullscreenEl && !framework.features.isOldAndroid) {\n          if (!_fullscrenAPI) {\n            _fullscrenAPI = ui.getFullscreenAPI();\n          }\n          if (_fullscrenAPI) {\n            framework.bind(document, _fullscrenAPI.eventK, ui.updateFullscreen);\n            ui.updateFullscreen();\n            framework.addClass(pswp.template, 'pswp--supports-fs');\n          } else {\n            framework.removeClass(pswp.template, 'pswp--supports-fs');\n          }\n        }\n      },\n      _setupLoadingIndicator = function () {\n        // Setup loading indicator\n        if (_options.preloaderEl) {\n          _toggleLoadingIndicator(true);\n          _listen('beforeChange', function () {\n            clearTimeout(_loadingIndicatorTimeout);\n\n            // display loading indicator with delay\n            _loadingIndicatorTimeout = setTimeout(function () {\n              if (pswp.currItem && pswp.currItem.loading) {\n                if (!pswp.allowProgressiveImg() || pswp.currItem.img && !pswp.currItem.img.naturalWidth) {\n                  // show preloader if progressive loading is not enabled, \n                  // or image width is not defined yet (because of slow connection)\n                  _toggleLoadingIndicator(false);\n                  // items-controller.js function allowProgressiveImg\n                }\n              } else {\n                _toggleLoadingIndicator(true); // hide preloader\n              }\n            }, _options.loadingIndicatorDelay);\n          });\n          _listen('imageLoadComplete', function (index, item) {\n            if (pswp.currItem === item) {\n              _toggleLoadingIndicator(true);\n            }\n          });\n        }\n      },\n      _toggleLoadingIndicator = function (hide) {\n        if (_loadingIndicatorHidden !== hide) {\n          _togglePswpClass(_loadingIndicator, 'preloader--active', !hide);\n          _loadingIndicatorHidden = hide;\n        }\n      },\n      _applyNavBarGaps = function (item) {\n        var gap = item.vGap;\n        if (_fitControlsInViewport()) {\n          var bars = _options.barsSize;\n          if (_options.captionEl && bars.bottom === 'auto') {\n            if (!_fakeCaptionContainer) {\n              _fakeCaptionContainer = framework.createEl('pswp__caption pswp__caption--fake');\n              _fakeCaptionContainer.appendChild(framework.createEl('pswp__caption__center'));\n              _controls.insertBefore(_fakeCaptionContainer, _captionContainer);\n              framework.addClass(_controls, 'pswp__ui--fit');\n            }\n            if (_options.addCaptionHTMLFn(item, _fakeCaptionContainer, true)) {\n              var captionSize = _fakeCaptionContainer.clientHeight;\n              gap.bottom = parseInt(captionSize, 10) || 44;\n            } else {\n              gap.bottom = bars.top; // if no caption, set size of bottom gap to size of top\n            }\n          } else {\n            gap.bottom = bars.bottom === 'auto' ? 0 : bars.bottom;\n          }\n\n          // height of top bar is static, no need to calculate it\n          gap.top = bars.top;\n        } else {\n          gap.top = gap.bottom = 0;\n        }\n      },\n      _setupIdle = function () {\n        // Hide controls when mouse is used\n        if (_options.timeToIdle) {\n          _listen('mouseUsed', function () {\n            framework.bind(document, 'mousemove', _onIdleMouseMove);\n            framework.bind(document, 'mouseout', _onMouseLeaveWindow);\n            _idleInterval = setInterval(function () {\n              _idleIncrement++;\n              if (_idleIncrement === 2) {\n                ui.setIdle(true);\n              }\n            }, _options.timeToIdle / 2);\n          });\n        }\n      },\n      _setupHidingControlsDuringGestures = function () {\n        // Hide controls on vertical drag\n        _listen('onVerticalDrag', function (now) {\n          if (_controlsVisible && now < 0.95) {\n            ui.hideControls();\n          } else if (!_controlsVisible && now >= 0.95) {\n            ui.showControls();\n          }\n        });\n\n        // Hide controls when pinching to close\n        var pinchControlsHidden;\n        _listen('onPinchClose', function (now) {\n          if (_controlsVisible && now < 0.9) {\n            ui.hideControls();\n            pinchControlsHidden = true;\n          } else if (pinchControlsHidden && !_controlsVisible && now > 0.9) {\n            ui.showControls();\n          }\n        });\n        _listen('zoomGestureEnded', function () {\n          pinchControlsHidden = false;\n          if (pinchControlsHidden && !_controlsVisible) {\n            ui.showControls();\n          }\n        });\n      };\n    var _uiElements = [{\n      name: 'caption',\n      option: 'captionEl',\n      onInit: function (el) {\n        _captionContainer = el;\n      }\n    }, {\n      name: 'share-modal',\n      option: 'shareEl',\n      onInit: function (el) {\n        _shareModal = el;\n      },\n      onTap: function () {\n        _toggleShareModal();\n      }\n    }, {\n      name: 'button--share',\n      option: 'shareEl',\n      onInit: function (el) {\n        _shareButton = el;\n      },\n      onTap: function () {\n        _toggleShareModal();\n      }\n    }, {\n      name: 'button--zoom',\n      option: 'zoomEl',\n      onTap: pswp.toggleDesktopZoom\n    }, {\n      name: 'counter',\n      option: 'counterEl',\n      onInit: function (el) {\n        _indexIndicator = el;\n      }\n    }, {\n      name: 'button--close',\n      option: 'closeEl',\n      onTap: pswp.close\n    }, {\n      name: 'button--arrow--left',\n      option: 'arrowEl',\n      onTap: pswp.prev\n    }, {\n      name: 'button--arrow--right',\n      option: 'arrowEl',\n      onTap: pswp.next\n    }, {\n      name: 'button--fs',\n      option: 'fullscreenEl',\n      onTap: function () {\n        if (_fullscrenAPI.isFullscreen()) {\n          _fullscrenAPI.exit();\n        } else {\n          _fullscrenAPI.enter();\n        }\n      }\n    }, {\n      name: 'preloader',\n      option: 'preloaderEl',\n      onInit: function (el) {\n        _loadingIndicator = el;\n      }\n    }];\n    var _setupUIElements = function () {\n      var item, classAttr, uiElement;\n      var loopThroughChildElements = function (sChildren) {\n        if (!sChildren) {\n          return;\n        }\n        var l = sChildren.length;\n        for (var i = 0; i < l; i++) {\n          item = sChildren[i];\n          classAttr = item.className;\n          for (var a = 0; a < _uiElements.length; a++) {\n            uiElement = _uiElements[a];\n            if (classAttr.indexOf('pswp__' + uiElement.name) > -1) {\n              if (_options[uiElement.option]) {\n                // if element is not disabled from options\n\n                framework.removeClass(item, 'pswp__element--disabled');\n                if (uiElement.onInit) {\n                  uiElement.onInit(item);\n                }\n\n                //item.style.display = 'block';\n              } else {\n                framework.addClass(item, 'pswp__element--disabled');\n                //item.style.display = 'none';\n              }\n            }\n          }\n        }\n      };\n      loopThroughChildElements(_controls.children);\n      var topBar = framework.getChildByClass(_controls, 'pswp__top-bar');\n      if (topBar) {\n        loopThroughChildElements(topBar.children);\n      }\n    };\n    ui.init = function () {\n      // extend options\n      framework.extend(pswp.options, _defaultUIOptions, true);\n\n      // create local link for fast access\n      _options = pswp.options;\n\n      // find pswp__ui element\n      _controls = framework.getChildByClass(pswp.scrollWrap, 'pswp__ui');\n\n      // create local link\n      _listen = pswp.listen;\n      _setupHidingControlsDuringGestures();\n\n      // update controls when slides change\n      _listen('beforeChange', ui.update);\n\n      // toggle zoom on double-tap\n      _listen('doubleTap', function (point) {\n        var initialZoomLevel = pswp.currItem.initialZoomLevel;\n        if (pswp.getZoomLevel() !== initialZoomLevel) {\n          pswp.zoomTo(initialZoomLevel, point, 333);\n        } else {\n          pswp.zoomTo(_options.getDoubleTapZoom(false, pswp.currItem), point, 333);\n        }\n      });\n\n      // Allow text selection in caption\n      _listen('preventDragEvent', function (e, isDown, preventObj) {\n        var t = e.target || e.srcElement;\n        if (t && t.getAttribute('class') && e.type.indexOf('mouse') > -1 && (t.getAttribute('class').indexOf('__caption') > 0 || /(SMALL|STRONG|EM)/i.test(t.tagName))) {\n          preventObj.prevent = false;\n        }\n      });\n\n      // bind events for UI\n      _listen('bindEvents', function () {\n        framework.bind(_controls, 'pswpTap click', _onControlsTap);\n        framework.bind(pswp.scrollWrap, 'pswpTap', ui.onGlobalTap);\n        if (!pswp.likelyTouchDevice) {\n          framework.bind(pswp.scrollWrap, 'mouseover', ui.onMouseOver);\n        }\n      });\n\n      // unbind events for UI\n      _listen('unbindEvents', function () {\n        if (!_shareModalHidden) {\n          _toggleShareModal();\n        }\n        if (_idleInterval) {\n          clearInterval(_idleInterval);\n        }\n        framework.unbind(document, 'mouseout', _onMouseLeaveWindow);\n        framework.unbind(document, 'mousemove', _onIdleMouseMove);\n        framework.unbind(_controls, 'pswpTap click', _onControlsTap);\n        framework.unbind(pswp.scrollWrap, 'pswpTap', ui.onGlobalTap);\n        framework.unbind(pswp.scrollWrap, 'mouseover', ui.onMouseOver);\n        if (_fullscrenAPI) {\n          framework.unbind(document, _fullscrenAPI.eventK, ui.updateFullscreen);\n          if (_fullscrenAPI.isFullscreen()) {\n            _options.hideAnimationDuration = 0;\n            _fullscrenAPI.exit();\n          }\n          _fullscrenAPI = null;\n        }\n      });\n\n      // clean up things when gallery is destroyed\n      _listen('destroy', function () {\n        if (_options.captionEl) {\n          if (_fakeCaptionContainer) {\n            _controls.removeChild(_fakeCaptionContainer);\n          }\n          framework.removeClass(_captionContainer, 'pswp__caption--empty');\n        }\n        if (_shareModal) {\n          _shareModal.children[0].onclick = null;\n        }\n        framework.removeClass(_controls, 'pswp__ui--over-close');\n        framework.addClass(_controls, 'pswp__ui--hidden');\n        ui.setIdle(false);\n      });\n      if (!_options.showAnimationDuration) {\n        framework.removeClass(_controls, 'pswp__ui--hidden');\n      }\n      _listen('initialZoomIn', function () {\n        if (_options.showAnimationDuration) {\n          framework.removeClass(_controls, 'pswp__ui--hidden');\n        }\n      });\n      _listen('initialZoomOut', function () {\n        framework.addClass(_controls, 'pswp__ui--hidden');\n      });\n      _listen('parseVerticalMargin', _applyNavBarGaps);\n      _setupUIElements();\n      if (_options.shareEl && _shareButton && _shareModal) {\n        _shareModalHidden = true;\n      }\n      _countNumItems();\n      _setupIdle();\n      _setupFullscreenAPI();\n      _setupLoadingIndicator();\n    };\n    ui.setIdle = function (isIdle) {\n      _isIdle = isIdle;\n      _togglePswpClass(_controls, 'ui--idle', isIdle);\n    };\n    ui.update = function () {\n      // Don't update UI if it's hidden\n      if (_controlsVisible && pswp.currItem) {\n        ui.updateIndexIndicator();\n        if (_options.captionEl) {\n          _options.addCaptionHTMLFn(pswp.currItem, _captionContainer);\n          _togglePswpClass(_captionContainer, 'caption--empty', !pswp.currItem.title);\n        }\n        _overlayUIUpdated = true;\n      } else {\n        _overlayUIUpdated = false;\n      }\n      if (!_shareModalHidden) {\n        _toggleShareModal();\n      }\n      _countNumItems();\n    };\n    ui.updateFullscreen = function (e) {\n      if (e) {\n        // some browsers change window scroll position during the fullscreen\n        // so PhotoSwipe updates it just in case\n        setTimeout(function () {\n          pswp.setScrollOffset(0, framework.getScrollY());\n        }, 50);\n      }\n\n      // toogle pswp--fs class on root element\n      framework[(_fullscrenAPI.isFullscreen() ? 'add' : 'remove') + 'Class'](pswp.template, 'pswp--fs');\n    };\n    ui.updateIndexIndicator = function () {\n      if (_options.counterEl) {\n        _indexIndicator.innerHTML = pswp.getCurrentIndex() + 1 + _options.indexIndicatorSep + _options.getNumItemsFn();\n      }\n    };\n    ui.onGlobalTap = function (e) {\n      e = e || window.event;\n      var target = e.target || e.srcElement;\n      if (_blockControlsTap) {\n        return;\n      }\n      if (e.detail && e.detail.pointerType === 'mouse') {\n        // close gallery if clicked outside of the image\n        if (_hasCloseClass(target)) {\n          pswp.close();\n          return;\n        }\n        if (framework.hasClass(target, 'pswp__img')) {\n          if (pswp.getZoomLevel() === 1 && pswp.getZoomLevel() <= pswp.currItem.fitRatio) {\n            if (_options.clickToCloseNonZoomable) {\n              pswp.close();\n            }\n          } else {\n            pswp.toggleDesktopZoom(e.detail.releasePoint);\n          }\n        }\n      } else {\n        // tap anywhere (except buttons) to toggle visibility of controls\n        if (_options.tapToToggleControls) {\n          if (_controlsVisible) {\n            ui.hideControls();\n          } else {\n            ui.showControls();\n          }\n        }\n\n        // tap to close gallery\n        if (_options.tapToClose && (framework.hasClass(target, 'pswp__img') || _hasCloseClass(target))) {\n          pswp.close();\n          return;\n        }\n      }\n    };\n    ui.onMouseOver = function (e) {\n      e = e || window.event;\n      var target = e.target || e.srcElement;\n\n      // add class when mouse is over an element that should close the gallery\n      _togglePswpClass(_controls, 'ui--over-close', _hasCloseClass(target));\n    };\n    ui.hideControls = function () {\n      framework.addClass(_controls, 'pswp__ui--hidden');\n      _controlsVisible = false;\n    };\n    ui.showControls = function () {\n      _controlsVisible = true;\n      if (!_overlayUIUpdated) {\n        ui.update();\n      }\n      framework.removeClass(_controls, 'pswp__ui--hidden');\n    };\n    ui.supportsFullscreen = function () {\n      var d = document;\n      return !!(d.exitFullscreen || d.mozCancelFullScreen || d.webkitExitFullscreen || d.msExitFullscreen);\n    };\n    ui.getFullscreenAPI = function () {\n      var dE = document.documentElement,\n        api,\n        tF = 'fullscreenchange';\n      if (dE.requestFullscreen) {\n        api = {\n          enterK: 'requestFullscreen',\n          exitK: 'exitFullscreen',\n          elementK: 'fullscreenElement',\n          eventK: tF\n        };\n      } else if (dE.mozRequestFullScreen) {\n        api = {\n          enterK: 'mozRequestFullScreen',\n          exitK: 'mozCancelFullScreen',\n          elementK: 'mozFullScreenElement',\n          eventK: 'moz' + tF\n        };\n      } else if (dE.webkitRequestFullscreen) {\n        api = {\n          enterK: 'webkitRequestFullscreen',\n          exitK: 'webkitExitFullscreen',\n          elementK: 'webkitFullscreenElement',\n          eventK: 'webkit' + tF\n        };\n      } else if (dE.msRequestFullscreen) {\n        api = {\n          enterK: 'msRequestFullscreen',\n          exitK: 'msExitFullscreen',\n          elementK: 'msFullscreenElement',\n          eventK: 'MSFullscreenChange'\n        };\n      }\n      if (api) {\n        api.enter = function () {\n          // disable close-on-scroll in fullscreen\n          _initalCloseOnScrollValue = _options.closeOnScroll;\n          _options.closeOnScroll = false;\n          if (this.enterK === 'webkitRequestFullscreen') {\n            pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT);\n          } else {\n            return pswp.template[this.enterK]();\n          }\n        };\n        api.exit = function () {\n          _options.closeOnScroll = _initalCloseOnScrollValue;\n          return document[this.exitK]();\n        };\n        api.isFullscreen = function () {\n          return document[this.elementK];\n        };\n      }\n      return api;\n    };\n  };\n  return PhotoSwipeUI_Default;\n});","/*! PhotoSwipe - v4.1.3 - 2019-01-08\n* http://photoswipe.com\n* Copyright (c) 2019 Dmitry Semenov; */\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.PhotoSwipe = factory();\n  }\n})(this, function () {\n  'use strict';\n\n  var PhotoSwipe = function (template, UiClass, items, options) {\n    /*>>framework-bridge*/\n    /**\n     *\n     * Set of generic functions used by gallery.\n     * \n     * You're free to modify anything here as long as functionality is kept.\n     * \n     */\n    var framework = {\n      features: null,\n      bind: function (target, type, listener, unbind) {\n        var methodName = (unbind ? 'remove' : 'add') + 'EventListener';\n        type = type.split(' ');\n        for (var i = 0; i < type.length; i++) {\n          if (type[i]) {\n            target[methodName](type[i], listener, false);\n          }\n        }\n      },\n      isArray: function (obj) {\n        return obj instanceof Array;\n      },\n      createEl: function (classes, tag) {\n        var el = document.createElement(tag || 'div');\n        if (classes) {\n          el.className = classes;\n        }\n        return el;\n      },\n      getScrollY: function () {\n        var yOffset = window.pageYOffset;\n        return yOffset !== undefined ? yOffset : document.documentElement.scrollTop;\n      },\n      unbind: function (target, type, listener) {\n        framework.bind(target, type, listener, true);\n      },\n      removeClass: function (el, className) {\n        var reg = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n        el.className = el.className.replace(reg, ' ').replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n      },\n      addClass: function (el, className) {\n        if (!framework.hasClass(el, className)) {\n          el.className += (el.className ? ' ' : '') + className;\n        }\n      },\n      hasClass: function (el, className) {\n        return el.className && new RegExp('(^|\\\\s)' + className + '(\\\\s|$)').test(el.className);\n      },\n      getChildByClass: function (parentEl, childClassName) {\n        var node = parentEl.firstChild;\n        while (node) {\n          if (framework.hasClass(node, childClassName)) {\n            return node;\n          }\n          node = node.nextSibling;\n        }\n      },\n      arraySearch: function (array, value, key) {\n        var i = array.length;\n        while (i--) {\n          if (array[i][key] === value) {\n            return i;\n          }\n        }\n        return -1;\n      },\n      extend: function (o1, o2, preventOverwrite) {\n        for (var prop in o2) {\n          if (o2.hasOwnProperty(prop)) {\n            if (preventOverwrite && o1.hasOwnProperty(prop)) {\n              continue;\n            }\n            o1[prop] = o2[prop];\n          }\n        }\n      },\n      easing: {\n        sine: {\n          out: function (k) {\n            return Math.sin(k * (Math.PI / 2));\n          },\n          inOut: function (k) {\n            return -(Math.cos(Math.PI * k) - 1) / 2;\n          }\n        },\n        cubic: {\n          out: function (k) {\n            return --k * k * k + 1;\n          }\n        }\n        /*\n        \telastic: {\n        \t\tout: function ( k ) {\n        \t\t\t\tvar s, a = 0.1, p = 0.4;\n        \t\t\tif ( k === 0 ) return 0;\n        \t\t\tif ( k === 1 ) return 1;\n        \t\t\tif ( !a || a < 1 ) { a = 1; s = p / 4; }\n        \t\t\telse s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n        \t\t\treturn ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n        \t\t\t},\n        \t},\n        \tback: {\n        \t\tout: function ( k ) {\n        \t\t\tvar s = 1.70158;\n        \t\t\treturn --k * k * ( ( s + 1 ) * k + s ) + 1;\n        \t\t}\n        \t}\n        */\n      },\n      /**\n       * \n       * @return {object}\n       * \n       * {\n       *  raf : request animation frame function\n       *  caf : cancel animation frame function\n       *  transfrom : transform property key (with vendor), or null if not supported\n       *  oldIE : IE8 or below\n       * }\n       * \n       */\n      detectFeatures: function () {\n        if (framework.features) {\n          return framework.features;\n        }\n        var helperEl = framework.createEl(),\n          helperStyle = helperEl.style,\n          vendor = '',\n          features = {};\n\n        // IE8 and below\n        features.oldIE = document.all && !document.addEventListener;\n        features.touch = 'ontouchstart' in window;\n        if (window.requestAnimationFrame) {\n          features.raf = window.requestAnimationFrame;\n          features.caf = window.cancelAnimationFrame;\n        }\n        features.pointerEvent = !!window.PointerEvent || navigator.msPointerEnabled;\n\n        // fix false-positive detection of old Android in new IE\n        // (IE11 ua string contains \"Android 4.0\")\n\n        if (!features.pointerEvent) {\n          var ua = navigator.userAgent;\n\n          // Detect if device is iPhone or iPod and if it's older than iOS 8\n          // http://stackoverflow.com/a/14223920\n          // \n          // This detection is made because of buggy top/bottom toolbars\n          // that don't trigger window.resize event.\n          // For more info refer to _isFixedPosition variable in core.js\n\n          if (/iP(hone|od)/.test(navigator.platform)) {\n            var v = navigator.appVersion.match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n            if (v && v.length > 0) {\n              v = parseInt(v[1], 10);\n              if (v >= 1 && v < 8) {\n                features.isOldIOSPhone = true;\n              }\n            }\n          }\n\n          // Detect old Android (before KitKat)\n          // due to bugs related to position:fixed\n          // http://stackoverflow.com/questions/7184573/pick-up-the-android-version-in-the-browser-by-javascript\n\n          var match = ua.match(/Android\\s([0-9\\.]*)/);\n          var androidversion = match ? match[1] : 0;\n          androidversion = parseFloat(androidversion);\n          if (androidversion >= 1) {\n            if (androidversion < 4.4) {\n              features.isOldAndroid = true; // for fixed position bug & performance\n            }\n            features.androidVersion = androidversion; // for touchend bug\n          }\n          features.isMobileOpera = /opera mini|opera mobi/i.test(ua);\n\n          // p.s. yes, yes, UA sniffing is bad, propose your solution for above bugs.\n        }\n        var styleChecks = ['transform', 'perspective', 'animationName'],\n          vendors = ['', 'webkit', 'Moz', 'ms', 'O'],\n          styleCheckItem,\n          styleName;\n        for (var i = 0; i < 4; i++) {\n          vendor = vendors[i];\n          for (var a = 0; a < 3; a++) {\n            styleCheckItem = styleChecks[a];\n\n            // uppercase first letter of property name, if vendor is present\n            styleName = vendor + (vendor ? styleCheckItem.charAt(0).toUpperCase() + styleCheckItem.slice(1) : styleCheckItem);\n            if (!features[styleCheckItem] && styleName in helperStyle) {\n              features[styleCheckItem] = styleName;\n            }\n          }\n          if (vendor && !features.raf) {\n            vendor = vendor.toLowerCase();\n            features.raf = window[vendor + 'RequestAnimationFrame'];\n            if (features.raf) {\n              features.caf = window[vendor + 'CancelAnimationFrame'] || window[vendor + 'CancelRequestAnimationFrame'];\n            }\n          }\n        }\n        if (!features.raf) {\n          var lastTime = 0;\n          features.raf = function (fn) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function () {\n              fn(currTime + timeToCall);\n            }, timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n          };\n          features.caf = function (id) {\n            clearTimeout(id);\n          };\n        }\n\n        // Detect SVG support\n        features.svg = !!document.createElementNS && !!document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect;\n        framework.features = features;\n        return features;\n      }\n    };\n    framework.detectFeatures();\n\n    // Override addEventListener for old versions of IE\n    if (framework.features.oldIE) {\n      framework.bind = function (target, type, listener, unbind) {\n        type = type.split(' ');\n        var methodName = (unbind ? 'detach' : 'attach') + 'Event',\n          evName,\n          _handleEv = function () {\n            listener.handleEvent.call(listener);\n          };\n        for (var i = 0; i < type.length; i++) {\n          evName = type[i];\n          if (evName) {\n            if (typeof listener === 'object' && listener.handleEvent) {\n              if (!unbind) {\n                listener['oldIE' + evName] = _handleEv;\n              } else {\n                if (!listener['oldIE' + evName]) {\n                  return false;\n                }\n              }\n              target[methodName]('on' + evName, listener['oldIE' + evName]);\n            } else {\n              target[methodName]('on' + evName, listener);\n            }\n          }\n        }\n      };\n    }\n\n    /*>>framework-bridge*/\n\n    /*>>core*/\n    //function(template, UiClass, items, options)\n\n    var self = this;\n\n    /**\n     * Static vars, don't change unless you know what you're doing.\n     */\n    var DOUBLE_TAP_RADIUS = 25,\n      NUM_HOLDERS = 3;\n\n    /**\n     * Options\n     */\n    var _options = {\n      allowPanToNext: true,\n      spacing: 0.12,\n      bgOpacity: 1,\n      mouseUsed: false,\n      loop: true,\n      pinchToClose: true,\n      closeOnScroll: true,\n      closeOnVerticalDrag: true,\n      verticalDragRange: 0.75,\n      hideAnimationDuration: 333,\n      showAnimationDuration: 333,\n      showHideOpacity: false,\n      focus: true,\n      escKey: true,\n      arrowKeys: true,\n      mainScrollEndFriction: 0.35,\n      panEndFriction: 0.35,\n      isClickableElement: function (el) {\n        return el.tagName === 'A';\n      },\n      getDoubleTapZoom: function (isMouseClick, item) {\n        if (isMouseClick) {\n          return 1;\n        } else {\n          return item.initialZoomLevel < 0.7 ? 1 : 1.33;\n        }\n      },\n      maxSpreadZoom: 1.33,\n      modal: true,\n      // not fully implemented yet\n      scaleMode: 'fit' // TODO\n    };\n    framework.extend(_options, options);\n\n    /**\n     * Private helper variables & functions\n     */\n\n    var _getEmptyPoint = function () {\n      return {\n        x: 0,\n        y: 0\n      };\n    };\n    var _isOpen,\n      _isDestroying,\n      _closedByScroll,\n      _currentItemIndex,\n      _containerStyle,\n      _containerShiftIndex,\n      _currPanDist = _getEmptyPoint(),\n      _startPanOffset = _getEmptyPoint(),\n      _panOffset = _getEmptyPoint(),\n      _upMoveEvents,\n      // drag move, drag end & drag cancel events array\n      _downEvents,\n      // drag start events array\n      _globalEventHandlers,\n      _viewportSize = {},\n      _currZoomLevel,\n      _startZoomLevel,\n      _translatePrefix,\n      _translateSufix,\n      _updateSizeInterval,\n      _itemsNeedUpdate,\n      _currPositionIndex = 0,\n      _offset = {},\n      _slideSize = _getEmptyPoint(),\n      // size of slide area, including spacing\n      _itemHolders,\n      _prevItemIndex,\n      _indexDiff = 0,\n      // difference of indexes since last content update\n      _dragStartEvent,\n      _dragMoveEvent,\n      _dragEndEvent,\n      _dragCancelEvent,\n      _transformKey,\n      _pointerEventEnabled,\n      _isFixedPosition = true,\n      _likelyTouchDevice,\n      _modules = [],\n      _requestAF,\n      _cancelAF,\n      _initalClassName,\n      _initalWindowScrollY,\n      _oldIE,\n      _currentWindowScrollY,\n      _features,\n      _windowVisibleSize = {},\n      _renderMaxResolution = false,\n      _orientationChangeTimeout,\n      // Registers PhotoSWipe module (History, Controller ...)\n      _registerModule = function (name, module) {\n        framework.extend(self, module.publicMethods);\n        _modules.push(name);\n      },\n      _getLoopedId = function (index) {\n        var numSlides = _getNumItems();\n        if (index > numSlides - 1) {\n          return index - numSlides;\n        } else if (index < 0) {\n          return numSlides + index;\n        }\n        return index;\n      },\n      // Micro bind/trigger\n      _listeners = {},\n      _listen = function (name, fn) {\n        if (!_listeners[name]) {\n          _listeners[name] = [];\n        }\n        return _listeners[name].push(fn);\n      },\n      _shout = function (name) {\n        var listeners = _listeners[name];\n        if (listeners) {\n          var args = Array.prototype.slice.call(arguments);\n          args.shift();\n          for (var i = 0; i < listeners.length; i++) {\n            listeners[i].apply(self, args);\n          }\n        }\n      },\n      _getCurrentTime = function () {\n        return new Date().getTime();\n      },\n      _applyBgOpacity = function (opacity) {\n        _bgOpacity = opacity;\n        self.bg.style.opacity = opacity * _options.bgOpacity;\n      },\n      _applyZoomTransform = function (styleObj, x, y, zoom, item) {\n        if (!_renderMaxResolution || item && item !== self.currItem) {\n          zoom = zoom / (item ? item.fitRatio : self.currItem.fitRatio);\n        }\n        styleObj[_transformKey] = _translatePrefix + x + 'px, ' + y + 'px' + _translateSufix + ' scale(' + zoom + ')';\n      },\n      _applyCurrentZoomPan = function (allowRenderResolution) {\n        if (_currZoomElementStyle) {\n          if (allowRenderResolution) {\n            if (_currZoomLevel > self.currItem.fitRatio) {\n              if (!_renderMaxResolution) {\n                _setImageSize(self.currItem, false, true);\n                _renderMaxResolution = true;\n              }\n            } else {\n              if (_renderMaxResolution) {\n                _setImageSize(self.currItem);\n                _renderMaxResolution = false;\n              }\n            }\n          }\n          _applyZoomTransform(_currZoomElementStyle, _panOffset.x, _panOffset.y, _currZoomLevel);\n        }\n      },\n      _applyZoomPanToItem = function (item) {\n        if (item.container) {\n          _applyZoomTransform(item.container.style, item.initialPosition.x, item.initialPosition.y, item.initialZoomLevel, item);\n        }\n      },\n      _setTranslateX = function (x, elStyle) {\n        elStyle[_transformKey] = _translatePrefix + x + 'px, 0px' + _translateSufix;\n      },\n      _moveMainScroll = function (x, dragging) {\n        if (!_options.loop && dragging) {\n          var newSlideIndexOffset = _currentItemIndex + (_slideSize.x * _currPositionIndex - x) / _slideSize.x,\n            delta = Math.round(x - _mainScrollPos.x);\n          if (newSlideIndexOffset < 0 && delta > 0 || newSlideIndexOffset >= _getNumItems() - 1 && delta < 0) {\n            x = _mainScrollPos.x + delta * _options.mainScrollEndFriction;\n          }\n        }\n        _mainScrollPos.x = x;\n        _setTranslateX(x, _containerStyle);\n      },\n      _calculatePanOffset = function (axis, zoomLevel) {\n        var m = _midZoomPoint[axis] - _offset[axis];\n        return _startPanOffset[axis] + _currPanDist[axis] + m - m * (zoomLevel / _startZoomLevel);\n      },\n      _equalizePoints = function (p1, p2) {\n        p1.x = p2.x;\n        p1.y = p2.y;\n        if (p2.id) {\n          p1.id = p2.id;\n        }\n      },\n      _roundPoint = function (p) {\n        p.x = Math.round(p.x);\n        p.y = Math.round(p.y);\n      },\n      _mouseMoveTimeout = null,\n      _onFirstMouseMove = function () {\n        // Wait until mouse move event is fired at least twice during 100ms\n        // We do this, because some mobile browsers trigger it on touchstart\n        if (_mouseMoveTimeout) {\n          framework.unbind(document, 'mousemove', _onFirstMouseMove);\n          framework.addClass(template, 'pswp--has_mouse');\n          _options.mouseUsed = true;\n          _shout('mouseUsed');\n        }\n        _mouseMoveTimeout = setTimeout(function () {\n          _mouseMoveTimeout = null;\n        }, 100);\n      },\n      _bindEvents = function () {\n        framework.bind(document, 'keydown', self);\n        if (_features.transform) {\n          // don't bind click event in browsers that don't support transform (mostly IE8)\n          framework.bind(self.scrollWrap, 'click', self);\n        }\n        if (!_options.mouseUsed) {\n          framework.bind(document, 'mousemove', _onFirstMouseMove);\n        }\n        framework.bind(window, 'resize scroll orientationchange', self);\n        _shout('bindEvents');\n      },\n      _unbindEvents = function () {\n        framework.unbind(window, 'resize scroll orientationchange', self);\n        framework.unbind(window, 'scroll', _globalEventHandlers.scroll);\n        framework.unbind(document, 'keydown', self);\n        framework.unbind(document, 'mousemove', _onFirstMouseMove);\n        if (_features.transform) {\n          framework.unbind(self.scrollWrap, 'click', self);\n        }\n        if (_isDragging) {\n          framework.unbind(window, _upMoveEvents, self);\n        }\n        clearTimeout(_orientationChangeTimeout);\n        _shout('unbindEvents');\n      },\n      _calculatePanBounds = function (zoomLevel, update) {\n        var bounds = _calculateItemSize(self.currItem, _viewportSize, zoomLevel);\n        if (update) {\n          _currPanBounds = bounds;\n        }\n        return bounds;\n      },\n      _getMinZoomLevel = function (item) {\n        if (!item) {\n          item = self.currItem;\n        }\n        return item.initialZoomLevel;\n      },\n      _getMaxZoomLevel = function (item) {\n        if (!item) {\n          item = self.currItem;\n        }\n        return item.w > 0 ? _options.maxSpreadZoom : 1;\n      },\n      // Return true if offset is out of the bounds\n      _modifyDestPanOffset = function (axis, destPanBounds, destPanOffset, destZoomLevel) {\n        if (destZoomLevel === self.currItem.initialZoomLevel) {\n          destPanOffset[axis] = self.currItem.initialPosition[axis];\n          return true;\n        } else {\n          destPanOffset[axis] = _calculatePanOffset(axis, destZoomLevel);\n          if (destPanOffset[axis] > destPanBounds.min[axis]) {\n            destPanOffset[axis] = destPanBounds.min[axis];\n            return true;\n          } else if (destPanOffset[axis] < destPanBounds.max[axis]) {\n            destPanOffset[axis] = destPanBounds.max[axis];\n            return true;\n          }\n        }\n        return false;\n      },\n      _setupTransforms = function () {\n        if (_transformKey) {\n          // setup 3d transforms\n          var allow3dTransform = _features.perspective && !_likelyTouchDevice;\n          _translatePrefix = 'translate' + (allow3dTransform ? '3d(' : '(');\n          _translateSufix = _features.perspective ? ', 0px)' : ')';\n          return;\n        }\n\n        // Override zoom/pan/move functions in case old browser is used (most likely IE)\n        // (so they use left/top/width/height, instead of CSS transform)\n\n        _transformKey = 'left';\n        framework.addClass(template, 'pswp--ie');\n        _setTranslateX = function (x, elStyle) {\n          elStyle.left = x + 'px';\n        };\n        _applyZoomPanToItem = function (item) {\n          var zoomRatio = item.fitRatio > 1 ? 1 : item.fitRatio,\n            s = item.container.style,\n            w = zoomRatio * item.w,\n            h = zoomRatio * item.h;\n          s.width = w + 'px';\n          s.height = h + 'px';\n          s.left = item.initialPosition.x + 'px';\n          s.top = item.initialPosition.y + 'px';\n        };\n        _applyCurrentZoomPan = function () {\n          if (_currZoomElementStyle) {\n            var s = _currZoomElementStyle,\n              item = self.currItem,\n              zoomRatio = item.fitRatio > 1 ? 1 : item.fitRatio,\n              w = zoomRatio * item.w,\n              h = zoomRatio * item.h;\n            s.width = w + 'px';\n            s.height = h + 'px';\n            s.left = _panOffset.x + 'px';\n            s.top = _panOffset.y + 'px';\n          }\n        };\n      },\n      _onKeyDown = function (e) {\n        var keydownAction = '';\n        if (_options.escKey && e.keyCode === 27) {\n          keydownAction = 'close';\n        } else if (_options.arrowKeys) {\n          if (e.keyCode === 37) {\n            keydownAction = 'prev';\n          } else if (e.keyCode === 39) {\n            keydownAction = 'next';\n          }\n        }\n        if (keydownAction) {\n          // don't do anything if special key pressed to prevent from overriding default browser actions\n          // e.g. in Chrome on Mac cmd+arrow-left returns to previous page\n          if (!e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey) {\n            if (e.preventDefault) {\n              e.preventDefault();\n            } else {\n              e.returnValue = false;\n            }\n            self[keydownAction]();\n          }\n        }\n      },\n      _onGlobalClick = function (e) {\n        if (!e) {\n          return;\n        }\n\n        // don't allow click event to pass through when triggering after drag or some other gesture\n        if (_moved || _zoomStarted || _mainScrollAnimating || _verticalDragInitiated) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      },\n      _updatePageScrollOffset = function () {\n        self.setScrollOffset(0, framework.getScrollY());\n      };\n\n    // Micro animation engine\n    var _animations = {},\n      _numAnimations = 0,\n      _stopAnimation = function (name) {\n        if (_animations[name]) {\n          if (_animations[name].raf) {\n            _cancelAF(_animations[name].raf);\n          }\n          _numAnimations--;\n          delete _animations[name];\n        }\n      },\n      _registerStartAnimation = function (name) {\n        if (_animations[name]) {\n          _stopAnimation(name);\n        }\n        if (!_animations[name]) {\n          _numAnimations++;\n          _animations[name] = {};\n        }\n      },\n      _stopAllAnimations = function () {\n        for (var prop in _animations) {\n          if (_animations.hasOwnProperty(prop)) {\n            _stopAnimation(prop);\n          }\n        }\n      },\n      _animateProp = function (name, b, endProp, d, easingFn, onUpdate, onComplete) {\n        var startAnimTime = _getCurrentTime(),\n          t;\n        _registerStartAnimation(name);\n        var animloop = function () {\n          if (_animations[name]) {\n            t = _getCurrentTime() - startAnimTime; // time diff\n            //b - beginning (start prop)\n            //d - anim duration\n\n            if (t >= d) {\n              _stopAnimation(name);\n              onUpdate(endProp);\n              if (onComplete) {\n                onComplete();\n              }\n              return;\n            }\n            onUpdate((endProp - b) * easingFn(t / d) + b);\n            _animations[name].raf = _requestAF(animloop);\n          }\n        };\n        animloop();\n      };\n    var publicMethods = {\n      // make a few local variables and functions public\n      shout: _shout,\n      listen: _listen,\n      viewportSize: _viewportSize,\n      options: _options,\n      isMainScrollAnimating: function () {\n        return _mainScrollAnimating;\n      },\n      getZoomLevel: function () {\n        return _currZoomLevel;\n      },\n      getCurrentIndex: function () {\n        return _currentItemIndex;\n      },\n      isDragging: function () {\n        return _isDragging;\n      },\n      isZooming: function () {\n        return _isZooming;\n      },\n      setScrollOffset: function (x, y) {\n        _offset.x = x;\n        _currentWindowScrollY = _offset.y = y;\n        _shout('updateScrollOffset', _offset);\n      },\n      applyZoomPan: function (zoomLevel, panX, panY, allowRenderResolution) {\n        _panOffset.x = panX;\n        _panOffset.y = panY;\n        _currZoomLevel = zoomLevel;\n        _applyCurrentZoomPan(allowRenderResolution);\n      },\n      init: function () {\n        if (_isOpen || _isDestroying) {\n          return;\n        }\n        var i;\n        self.framework = framework; // basic functionality\n        self.template = template; // root DOM element of PhotoSwipe\n        self.bg = framework.getChildByClass(template, 'pswp__bg');\n        _initalClassName = template.className;\n        _isOpen = true;\n        _features = framework.detectFeatures();\n        _requestAF = _features.raf;\n        _cancelAF = _features.caf;\n        _transformKey = _features.transform;\n        _oldIE = _features.oldIE;\n        self.scrollWrap = framework.getChildByClass(template, 'pswp__scroll-wrap');\n        self.container = framework.getChildByClass(self.scrollWrap, 'pswp__container');\n        _containerStyle = self.container.style; // for fast access\n\n        // Objects that hold slides (there are only 3 in DOM)\n        self.itemHolders = _itemHolders = [{\n          el: self.container.children[0],\n          wrap: 0,\n          index: -1\n        }, {\n          el: self.container.children[1],\n          wrap: 0,\n          index: -1\n        }, {\n          el: self.container.children[2],\n          wrap: 0,\n          index: -1\n        }];\n\n        // hide nearby item holders until initial zoom animation finishes (to avoid extra Paints)\n        _itemHolders[0].el.style.display = _itemHolders[2].el.style.display = 'none';\n        _setupTransforms();\n\n        // Setup global events\n        _globalEventHandlers = {\n          resize: self.updateSize,\n          // Fixes: iOS 10.3 resize event\n          // does not update scrollWrap.clientWidth instantly after resize\n          // https://github.com/dimsemenov/PhotoSwipe/issues/1315\n          orientationchange: function () {\n            clearTimeout(_orientationChangeTimeout);\n            _orientationChangeTimeout = setTimeout(function () {\n              if (_viewportSize.x !== self.scrollWrap.clientWidth) {\n                self.updateSize();\n              }\n            }, 500);\n          },\n          scroll: _updatePageScrollOffset,\n          keydown: _onKeyDown,\n          click: _onGlobalClick\n        };\n\n        // disable show/hide effects on old browsers that don't support CSS animations or transforms, \n        // old IOS, Android and Opera mobile. Blackberry seems to work fine, even older models.\n        var oldPhone = _features.isOldIOSPhone || _features.isOldAndroid || _features.isMobileOpera;\n        if (!_features.animationName || !_features.transform || oldPhone) {\n          _options.showAnimationDuration = _options.hideAnimationDuration = 0;\n        }\n\n        // init modules\n        for (i = 0; i < _modules.length; i++) {\n          self['init' + _modules[i]]();\n        }\n\n        // init\n        if (UiClass) {\n          var ui = self.ui = new UiClass(self, framework);\n          ui.init();\n        }\n        _shout('firstUpdate');\n        _currentItemIndex = _currentItemIndex || _options.index || 0;\n        // validate index\n        if (isNaN(_currentItemIndex) || _currentItemIndex < 0 || _currentItemIndex >= _getNumItems()) {\n          _currentItemIndex = 0;\n        }\n        self.currItem = _getItemAt(_currentItemIndex);\n        if (_features.isOldIOSPhone || _features.isOldAndroid) {\n          _isFixedPosition = false;\n        }\n        template.setAttribute('aria-hidden', 'false');\n        if (_options.modal) {\n          if (!_isFixedPosition) {\n            template.style.position = 'absolute';\n            template.style.top = framework.getScrollY() + 'px';\n          } else {\n            template.style.position = 'fixed';\n          }\n        }\n        if (_currentWindowScrollY === undefined) {\n          _shout('initialLayout');\n          _currentWindowScrollY = _initalWindowScrollY = framework.getScrollY();\n        }\n\n        // add classes to root element of PhotoSwipe\n        var rootClasses = 'pswp--open ';\n        if (_options.mainClass) {\n          rootClasses += _options.mainClass + ' ';\n        }\n        if (_options.showHideOpacity) {\n          rootClasses += 'pswp--animate_opacity ';\n        }\n        rootClasses += _likelyTouchDevice ? 'pswp--touch' : 'pswp--notouch';\n        rootClasses += _features.animationName ? ' pswp--css_animation' : '';\n        rootClasses += _features.svg ? ' pswp--svg' : '';\n        framework.addClass(template, rootClasses);\n        self.updateSize();\n\n        // initial update\n        _containerShiftIndex = -1;\n        _indexDiff = null;\n        for (i = 0; i < NUM_HOLDERS; i++) {\n          _setTranslateX((i + _containerShiftIndex) * _slideSize.x, _itemHolders[i].el.style);\n        }\n        if (!_oldIE) {\n          framework.bind(self.scrollWrap, _downEvents, self); // no dragging for old IE\n        }\n        _listen('initialZoomInEnd', function () {\n          self.setContent(_itemHolders[0], _currentItemIndex - 1);\n          self.setContent(_itemHolders[2], _currentItemIndex + 1);\n          _itemHolders[0].el.style.display = _itemHolders[2].el.style.display = 'block';\n          if (_options.focus) {\n            // focus causes layout, \n            // which causes lag during the animation, \n            // that's why we delay it untill the initial zoom transition ends\n            template.focus();\n          }\n          _bindEvents();\n        });\n\n        // set content for center slide (first time)\n        self.setContent(_itemHolders[1], _currentItemIndex);\n        self.updateCurrItem();\n        _shout('afterInit');\n        if (!_isFixedPosition) {\n          // On all versions of iOS lower than 8.0, we check size of viewport every second.\n          // \n          // This is done to detect when Safari top & bottom bars appear, \n          // as this action doesn't trigger any events (like resize). \n          // \n          // On iOS8 they fixed this.\n          // \n          // 10 Nov 2014: iOS 7 usage ~40%. iOS 8 usage 56%.\n\n          _updateSizeInterval = setInterval(function () {\n            if (!_numAnimations && !_isDragging && !_isZooming && _currZoomLevel === self.currItem.initialZoomLevel) {\n              self.updateSize();\n            }\n          }, 1000);\n        }\n        framework.addClass(template, 'pswp--visible');\n      },\n      // Close the gallery, then destroy it\n      close: function () {\n        if (!_isOpen) {\n          return;\n        }\n        _isOpen = false;\n        _isDestroying = true;\n        _shout('close');\n        _unbindEvents();\n        _showOrHide(self.currItem, null, true, self.destroy);\n      },\n      // destroys the gallery (unbinds events, cleans up intervals and timeouts to avoid memory leaks)\n      destroy: function () {\n        _shout('destroy');\n        if (_showOrHideTimeout) {\n          clearTimeout(_showOrHideTimeout);\n        }\n        template.setAttribute('aria-hidden', 'true');\n        template.className = _initalClassName;\n        if (_updateSizeInterval) {\n          clearInterval(_updateSizeInterval);\n        }\n        framework.unbind(self.scrollWrap, _downEvents, self);\n\n        // we unbind scroll event at the end, as closing animation may depend on it\n        framework.unbind(window, 'scroll', self);\n        _stopDragUpdateLoop();\n        _stopAllAnimations();\n        _listeners = null;\n      },\n      /**\n       * Pan image to position\n       * @param {Number} x     \n       * @param {Number} y     \n       * @param {Boolean} force Will ignore bounds if set to true.\n       */\n      panTo: function (x, y, force) {\n        if (!force) {\n          if (x > _currPanBounds.min.x) {\n            x = _currPanBounds.min.x;\n          } else if (x < _currPanBounds.max.x) {\n            x = _currPanBounds.max.x;\n          }\n          if (y > _currPanBounds.min.y) {\n            y = _currPanBounds.min.y;\n          } else if (y < _currPanBounds.max.y) {\n            y = _currPanBounds.max.y;\n          }\n        }\n        _panOffset.x = x;\n        _panOffset.y = y;\n        _applyCurrentZoomPan();\n      },\n      handleEvent: function (e) {\n        e = e || window.event;\n        if (_globalEventHandlers[e.type]) {\n          _globalEventHandlers[e.type](e);\n        }\n      },\n      goTo: function (index) {\n        index = _getLoopedId(index);\n        var diff = index - _currentItemIndex;\n        _indexDiff = diff;\n        _currentItemIndex = index;\n        self.currItem = _getItemAt(_currentItemIndex);\n        _currPositionIndex -= diff;\n        _moveMainScroll(_slideSize.x * _currPositionIndex);\n        _stopAllAnimations();\n        _mainScrollAnimating = false;\n        self.updateCurrItem();\n      },\n      next: function () {\n        self.goTo(_currentItemIndex + 1);\n      },\n      prev: function () {\n        self.goTo(_currentItemIndex - 1);\n      },\n      // update current zoom/pan objects\n      updateCurrZoomItem: function (emulateSetContent) {\n        if (emulateSetContent) {\n          _shout('beforeChange', 0);\n        }\n\n        // itemHolder[1] is middle (current) item\n        if (_itemHolders[1].el.children.length) {\n          var zoomElement = _itemHolders[1].el.children[0];\n          if (framework.hasClass(zoomElement, 'pswp__zoom-wrap')) {\n            _currZoomElementStyle = zoomElement.style;\n          } else {\n            _currZoomElementStyle = null;\n          }\n        } else {\n          _currZoomElementStyle = null;\n        }\n        _currPanBounds = self.currItem.bounds;\n        _startZoomLevel = _currZoomLevel = self.currItem.initialZoomLevel;\n        _panOffset.x = _currPanBounds.center.x;\n        _panOffset.y = _currPanBounds.center.y;\n        if (emulateSetContent) {\n          _shout('afterChange');\n        }\n      },\n      invalidateCurrItems: function () {\n        _itemsNeedUpdate = true;\n        for (var i = 0; i < NUM_HOLDERS; i++) {\n          if (_itemHolders[i].item) {\n            _itemHolders[i].item.needsUpdate = true;\n          }\n        }\n      },\n      updateCurrItem: function (beforeAnimation) {\n        if (_indexDiff === 0) {\n          return;\n        }\n        var diffAbs = Math.abs(_indexDiff),\n          tempHolder;\n        if (beforeAnimation && diffAbs < 2) {\n          return;\n        }\n        self.currItem = _getItemAt(_currentItemIndex);\n        _renderMaxResolution = false;\n        _shout('beforeChange', _indexDiff);\n        if (diffAbs >= NUM_HOLDERS) {\n          _containerShiftIndex += _indexDiff + (_indexDiff > 0 ? -NUM_HOLDERS : NUM_HOLDERS);\n          diffAbs = NUM_HOLDERS;\n        }\n        for (var i = 0; i < diffAbs; i++) {\n          if (_indexDiff > 0) {\n            tempHolder = _itemHolders.shift();\n            _itemHolders[NUM_HOLDERS - 1] = tempHolder; // move first to last\n\n            _containerShiftIndex++;\n            _setTranslateX((_containerShiftIndex + 2) * _slideSize.x, tempHolder.el.style);\n            self.setContent(tempHolder, _currentItemIndex - diffAbs + i + 1 + 1);\n          } else {\n            tempHolder = _itemHolders.pop();\n            _itemHolders.unshift(tempHolder); // move last to first\n\n            _containerShiftIndex--;\n            _setTranslateX(_containerShiftIndex * _slideSize.x, tempHolder.el.style);\n            self.setContent(tempHolder, _currentItemIndex + diffAbs - i - 1 - 1);\n          }\n        }\n\n        // reset zoom/pan on previous item\n        if (_currZoomElementStyle && Math.abs(_indexDiff) === 1) {\n          var prevItem = _getItemAt(_prevItemIndex);\n          if (prevItem.initialZoomLevel !== _currZoomLevel) {\n            _calculateItemSize(prevItem, _viewportSize);\n            _setImageSize(prevItem);\n            _applyZoomPanToItem(prevItem);\n          }\n        }\n\n        // reset diff after update\n        _indexDiff = 0;\n        self.updateCurrZoomItem();\n        _prevItemIndex = _currentItemIndex;\n        _shout('afterChange');\n      },\n      updateSize: function (force) {\n        if (!_isFixedPosition && _options.modal) {\n          var windowScrollY = framework.getScrollY();\n          if (_currentWindowScrollY !== windowScrollY) {\n            template.style.top = windowScrollY + 'px';\n            _currentWindowScrollY = windowScrollY;\n          }\n          if (!force && _windowVisibleSize.x === window.innerWidth && _windowVisibleSize.y === window.innerHeight) {\n            return;\n          }\n          _windowVisibleSize.x = window.innerWidth;\n          _windowVisibleSize.y = window.innerHeight;\n\n          //template.style.width = _windowVisibleSize.x + 'px';\n          template.style.height = _windowVisibleSize.y + 'px';\n        }\n        _viewportSize.x = self.scrollWrap.clientWidth;\n        _viewportSize.y = self.scrollWrap.clientHeight;\n        _updatePageScrollOffset();\n        _slideSize.x = _viewportSize.x + Math.round(_viewportSize.x * _options.spacing);\n        _slideSize.y = _viewportSize.y;\n        _moveMainScroll(_slideSize.x * _currPositionIndex);\n        _shout('beforeResize'); // even may be used for example to switch image sources\n\n        // don't re-calculate size on inital size update\n        if (_containerShiftIndex !== undefined) {\n          var holder, item, hIndex;\n          for (var i = 0; i < NUM_HOLDERS; i++) {\n            holder = _itemHolders[i];\n            _setTranslateX((i + _containerShiftIndex) * _slideSize.x, holder.el.style);\n            hIndex = _currentItemIndex + i - 1;\n            if (_options.loop && _getNumItems() > 2) {\n              hIndex = _getLoopedId(hIndex);\n            }\n\n            // update zoom level on items and refresh source (if needsUpdate)\n            item = _getItemAt(hIndex);\n\n            // re-render gallery item if `needsUpdate`,\n            // or doesn't have `bounds` (entirely new slide object)\n            if (item && (_itemsNeedUpdate || item.needsUpdate || !item.bounds)) {\n              self.cleanSlide(item);\n              self.setContent(holder, hIndex);\n\n              // if \"center\" slide\n              if (i === 1) {\n                self.currItem = item;\n                self.updateCurrZoomItem(true);\n              }\n              item.needsUpdate = false;\n            } else if (holder.index === -1 && hIndex >= 0) {\n              // add content first time\n              self.setContent(holder, hIndex);\n            }\n            if (item && item.container) {\n              _calculateItemSize(item, _viewportSize);\n              _setImageSize(item);\n              _applyZoomPanToItem(item);\n            }\n          }\n          _itemsNeedUpdate = false;\n        }\n        _startZoomLevel = _currZoomLevel = self.currItem.initialZoomLevel;\n        _currPanBounds = self.currItem.bounds;\n        if (_currPanBounds) {\n          _panOffset.x = _currPanBounds.center.x;\n          _panOffset.y = _currPanBounds.center.y;\n          _applyCurrentZoomPan(true);\n        }\n        _shout('resize');\n      },\n      // Zoom current item to\n      zoomTo: function (destZoomLevel, centerPoint, speed, easingFn, updateFn) {\n        /*\n        \tif(destZoomLevel === 'fit') {\n        \t\tdestZoomLevel = self.currItem.fitRatio;\n        \t} else if(destZoomLevel === 'fill') {\n        \t\tdestZoomLevel = self.currItem.fillRatio;\n        \t}\n        */\n\n        if (centerPoint) {\n          _startZoomLevel = _currZoomLevel;\n          _midZoomPoint.x = Math.abs(centerPoint.x) - _panOffset.x;\n          _midZoomPoint.y = Math.abs(centerPoint.y) - _panOffset.y;\n          _equalizePoints(_startPanOffset, _panOffset);\n        }\n        var destPanBounds = _calculatePanBounds(destZoomLevel, false),\n          destPanOffset = {};\n        _modifyDestPanOffset('x', destPanBounds, destPanOffset, destZoomLevel);\n        _modifyDestPanOffset('y', destPanBounds, destPanOffset, destZoomLevel);\n        var initialZoomLevel = _currZoomLevel;\n        var initialPanOffset = {\n          x: _panOffset.x,\n          y: _panOffset.y\n        };\n        _roundPoint(destPanOffset);\n        var onUpdate = function (now) {\n          if (now === 1) {\n            _currZoomLevel = destZoomLevel;\n            _panOffset.x = destPanOffset.x;\n            _panOffset.y = destPanOffset.y;\n          } else {\n            _currZoomLevel = (destZoomLevel - initialZoomLevel) * now + initialZoomLevel;\n            _panOffset.x = (destPanOffset.x - initialPanOffset.x) * now + initialPanOffset.x;\n            _panOffset.y = (destPanOffset.y - initialPanOffset.y) * now + initialPanOffset.y;\n          }\n          if (updateFn) {\n            updateFn(now);\n          }\n          _applyCurrentZoomPan(now === 1);\n        };\n        if (speed) {\n          _animateProp('customZoomTo', 0, 1, speed, easingFn || framework.easing.sine.inOut, onUpdate);\n        } else {\n          onUpdate(1);\n        }\n      }\n    };\n\n    /*>>core*/\n\n    /*>>gestures*/\n    /**\n     * Mouse/touch/pointer event handlers.\n     * \n     * separated from @core.js for readability\n     */\n\n    var MIN_SWIPE_DISTANCE = 30,\n      DIRECTION_CHECK_OFFSET = 10; // amount of pixels to drag to determine direction of swipe\n\n    var _gestureStartTime,\n      _gestureCheckSpeedTime,\n      // pool of objects that are used during dragging of zooming\n      p = {},\n      // first point\n      p2 = {},\n      // second point (for zoom gesture)\n      delta = {},\n      _currPoint = {},\n      _startPoint = {},\n      _currPointers = [],\n      _startMainScrollPos = {},\n      _releaseAnimData,\n      _posPoints = [],\n      // array of points during dragging, used to determine type of gesture\n      _tempPoint = {},\n      _isZoomingIn,\n      _verticalDragInitiated,\n      _oldAndroidTouchEndTimeout,\n      _currZoomedItemIndex = 0,\n      _centerPoint = _getEmptyPoint(),\n      _lastReleaseTime = 0,\n      _isDragging,\n      // at least one pointer is down\n      _isMultitouch,\n      // at least two _pointers are down\n      _zoomStarted,\n      // zoom level changed during zoom gesture\n      _moved,\n      _dragAnimFrame,\n      _mainScrollShifted,\n      _currentPoints,\n      // array of current touch points\n      _isZooming,\n      _currPointsDistance,\n      _startPointsDistance,\n      _currPanBounds,\n      _mainScrollPos = _getEmptyPoint(),\n      _currZoomElementStyle,\n      _mainScrollAnimating,\n      // true, if animation after swipe gesture is running\n      _midZoomPoint = _getEmptyPoint(),\n      _currCenterPoint = _getEmptyPoint(),\n      _direction,\n      _isFirstMove,\n      _opacityChanged,\n      _bgOpacity,\n      _wasOverInitialZoom,\n      _isEqualPoints = function (p1, p2) {\n        return p1.x === p2.x && p1.y === p2.y;\n      },\n      _isNearbyPoints = function (touch0, touch1) {\n        return Math.abs(touch0.x - touch1.x) < DOUBLE_TAP_RADIUS && Math.abs(touch0.y - touch1.y) < DOUBLE_TAP_RADIUS;\n      },\n      _calculatePointsDistance = function (p1, p2) {\n        _tempPoint.x = Math.abs(p1.x - p2.x);\n        _tempPoint.y = Math.abs(p1.y - p2.y);\n        return Math.sqrt(_tempPoint.x * _tempPoint.x + _tempPoint.y * _tempPoint.y);\n      },\n      _stopDragUpdateLoop = function () {\n        if (_dragAnimFrame) {\n          _cancelAF(_dragAnimFrame);\n          _dragAnimFrame = null;\n        }\n      },\n      _dragUpdateLoop = function () {\n        if (_isDragging) {\n          _dragAnimFrame = _requestAF(_dragUpdateLoop);\n          _renderMovement();\n        }\n      },\n      _canPan = function () {\n        return !(_options.scaleMode === 'fit' && _currZoomLevel === self.currItem.initialZoomLevel);\n      },\n      // find the closest parent DOM element\n      _closestElement = function (el, fn) {\n        if (!el || el === document) {\n          return false;\n        }\n\n        // don't search elements above pswp__scroll-wrap\n        if (el.getAttribute('class') && el.getAttribute('class').indexOf('pswp__scroll-wrap') > -1) {\n          return false;\n        }\n        if (fn(el)) {\n          return el;\n        }\n        return _closestElement(el.parentNode, fn);\n      },\n      _preventObj = {},\n      _preventDefaultEventBehaviour = function (e, isDown) {\n        _preventObj.prevent = !_closestElement(e.target, _options.isClickableElement);\n        _shout('preventDragEvent', e, isDown, _preventObj);\n        return _preventObj.prevent;\n      },\n      _convertTouchToPoint = function (touch, p) {\n        p.x = touch.pageX;\n        p.y = touch.pageY;\n        p.id = touch.identifier;\n        return p;\n      },\n      _findCenterOfPoints = function (p1, p2, pCenter) {\n        pCenter.x = (p1.x + p2.x) * 0.5;\n        pCenter.y = (p1.y + p2.y) * 0.5;\n      },\n      _pushPosPoint = function (time, x, y) {\n        if (time - _gestureCheckSpeedTime > 50) {\n          var o = _posPoints.length > 2 ? _posPoints.shift() : {};\n          o.x = x;\n          o.y = y;\n          _posPoints.push(o);\n          _gestureCheckSpeedTime = time;\n        }\n      },\n      _calculateVerticalDragOpacityRatio = function () {\n        var yOffset = _panOffset.y - self.currItem.initialPosition.y; // difference between initial and current position\n        return 1 - Math.abs(yOffset / (_viewportSize.y / 2));\n      },\n      // points pool, reused during touch events\n      _ePoint1 = {},\n      _ePoint2 = {},\n      _tempPointsArr = [],\n      _tempCounter,\n      _getTouchPoints = function (e) {\n        // clean up previous points, without recreating array\n        while (_tempPointsArr.length > 0) {\n          _tempPointsArr.pop();\n        }\n        if (!_pointerEventEnabled) {\n          if (e.type.indexOf('touch') > -1) {\n            if (e.touches && e.touches.length > 0) {\n              _tempPointsArr[0] = _convertTouchToPoint(e.touches[0], _ePoint1);\n              if (e.touches.length > 1) {\n                _tempPointsArr[1] = _convertTouchToPoint(e.touches[1], _ePoint2);\n              }\n            }\n          } else {\n            _ePoint1.x = e.pageX;\n            _ePoint1.y = e.pageY;\n            _ePoint1.id = '';\n            _tempPointsArr[0] = _ePoint1; //_ePoint1;\n          }\n        } else {\n          _tempCounter = 0;\n          // we can use forEach, as pointer events are supported only in modern browsers\n          _currPointers.forEach(function (p) {\n            if (_tempCounter === 0) {\n              _tempPointsArr[0] = p;\n            } else if (_tempCounter === 1) {\n              _tempPointsArr[1] = p;\n            }\n            _tempCounter++;\n          });\n        }\n        return _tempPointsArr;\n      },\n      _panOrMoveMainScroll = function (axis, delta) {\n        var panFriction,\n          overDiff = 0,\n          newOffset = _panOffset[axis] + delta[axis],\n          startOverDiff,\n          dir = delta[axis] > 0,\n          newMainScrollPosition = _mainScrollPos.x + delta.x,\n          mainScrollDiff = _mainScrollPos.x - _startMainScrollPos.x,\n          newPanPos,\n          newMainScrollPos;\n\n        // calculate fdistance over the bounds and friction\n        if (newOffset > _currPanBounds.min[axis] || newOffset < _currPanBounds.max[axis]) {\n          panFriction = _options.panEndFriction;\n          // Linear increasing of friction, so at 1/4 of viewport it's at max value. \n          // Looks not as nice as was expected. Left for history.\n          // panFriction = (1 - (_panOffset[axis] + delta[axis] + panBounds.min[axis]) / (_viewportSize[axis] / 4) );\n        } else {\n          panFriction = 1;\n        }\n        newOffset = _panOffset[axis] + delta[axis] * panFriction;\n\n        // move main scroll or start panning\n        if (_options.allowPanToNext || _currZoomLevel === self.currItem.initialZoomLevel) {\n          if (!_currZoomElementStyle) {\n            newMainScrollPos = newMainScrollPosition;\n          } else if (_direction === 'h' && axis === 'x' && !_zoomStarted) {\n            if (dir) {\n              if (newOffset > _currPanBounds.min[axis]) {\n                panFriction = _options.panEndFriction;\n                overDiff = _currPanBounds.min[axis] - newOffset;\n                startOverDiff = _currPanBounds.min[axis] - _startPanOffset[axis];\n              }\n\n              // drag right\n              if ((startOverDiff <= 0 || mainScrollDiff < 0) && _getNumItems() > 1) {\n                newMainScrollPos = newMainScrollPosition;\n                if (mainScrollDiff < 0 && newMainScrollPosition > _startMainScrollPos.x) {\n                  newMainScrollPos = _startMainScrollPos.x;\n                }\n              } else {\n                if (_currPanBounds.min.x !== _currPanBounds.max.x) {\n                  newPanPos = newOffset;\n                }\n              }\n            } else {\n              if (newOffset < _currPanBounds.max[axis]) {\n                panFriction = _options.panEndFriction;\n                overDiff = newOffset - _currPanBounds.max[axis];\n                startOverDiff = _startPanOffset[axis] - _currPanBounds.max[axis];\n              }\n              if ((startOverDiff <= 0 || mainScrollDiff > 0) && _getNumItems() > 1) {\n                newMainScrollPos = newMainScrollPosition;\n                if (mainScrollDiff > 0 && newMainScrollPosition < _startMainScrollPos.x) {\n                  newMainScrollPos = _startMainScrollPos.x;\n                }\n              } else {\n                if (_currPanBounds.min.x !== _currPanBounds.max.x) {\n                  newPanPos = newOffset;\n                }\n              }\n            }\n\n            //\n          }\n          if (axis === 'x') {\n            if (newMainScrollPos !== undefined) {\n              _moveMainScroll(newMainScrollPos, true);\n              if (newMainScrollPos === _startMainScrollPos.x) {\n                _mainScrollShifted = false;\n              } else {\n                _mainScrollShifted = true;\n              }\n            }\n            if (_currPanBounds.min.x !== _currPanBounds.max.x) {\n              if (newPanPos !== undefined) {\n                _panOffset.x = newPanPos;\n              } else if (!_mainScrollShifted) {\n                _panOffset.x += delta.x * panFriction;\n              }\n            }\n            return newMainScrollPos !== undefined;\n          }\n        }\n        if (!_mainScrollAnimating) {\n          if (!_mainScrollShifted) {\n            if (_currZoomLevel > self.currItem.fitRatio) {\n              _panOffset[axis] += delta[axis] * panFriction;\n            }\n          }\n        }\n      },\n      // Pointerdown/touchstart/mousedown handler\n      _onDragStart = function (e) {\n        // Allow dragging only via left mouse button.\n        // As this handler is not added in IE8 - we ignore e.which\n        // \n        // http://www.quirksmode.org/js/events_properties.html\n        // https://developer.mozilla.org/en-US/docs/Web/API/event.button\n        if (e.type === 'mousedown' && e.button > 0) {\n          return;\n        }\n        if (_initialZoomRunning) {\n          e.preventDefault();\n          return;\n        }\n        if (_oldAndroidTouchEndTimeout && e.type === 'mousedown') {\n          return;\n        }\n        if (_preventDefaultEventBehaviour(e, true)) {\n          e.preventDefault();\n        }\n        _shout('pointerDown');\n        if (_pointerEventEnabled) {\n          var pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n          if (pointerIndex < 0) {\n            pointerIndex = _currPointers.length;\n          }\n          _currPointers[pointerIndex] = {\n            x: e.pageX,\n            y: e.pageY,\n            id: e.pointerId\n          };\n        }\n        var startPointsList = _getTouchPoints(e),\n          numPoints = startPointsList.length;\n        _currentPoints = null;\n        _stopAllAnimations();\n\n        // init drag\n        if (!_isDragging || numPoints === 1) {\n          _isDragging = _isFirstMove = true;\n          framework.bind(window, _upMoveEvents, self);\n          _isZoomingIn = _wasOverInitialZoom = _opacityChanged = _verticalDragInitiated = _mainScrollShifted = _moved = _isMultitouch = _zoomStarted = false;\n          _direction = null;\n          _shout('firstTouchStart', startPointsList);\n          _equalizePoints(_startPanOffset, _panOffset);\n          _currPanDist.x = _currPanDist.y = 0;\n          _equalizePoints(_currPoint, startPointsList[0]);\n          _equalizePoints(_startPoint, _currPoint);\n\n          //_equalizePoints(_startMainScrollPos, _mainScrollPos);\n          _startMainScrollPos.x = _slideSize.x * _currPositionIndex;\n          _posPoints = [{\n            x: _currPoint.x,\n            y: _currPoint.y\n          }];\n          _gestureCheckSpeedTime = _gestureStartTime = _getCurrentTime();\n\n          //_mainScrollAnimationEnd(true);\n          _calculatePanBounds(_currZoomLevel, true);\n\n          // Start rendering\n          _stopDragUpdateLoop();\n          _dragUpdateLoop();\n        }\n\n        // init zoom\n        if (!_isZooming && numPoints > 1 && !_mainScrollAnimating && !_mainScrollShifted) {\n          _startZoomLevel = _currZoomLevel;\n          _zoomStarted = false; // true if zoom changed at least once\n\n          _isZooming = _isMultitouch = true;\n          _currPanDist.y = _currPanDist.x = 0;\n          _equalizePoints(_startPanOffset, _panOffset);\n          _equalizePoints(p, startPointsList[0]);\n          _equalizePoints(p2, startPointsList[1]);\n          _findCenterOfPoints(p, p2, _currCenterPoint);\n          _midZoomPoint.x = Math.abs(_currCenterPoint.x) - _panOffset.x;\n          _midZoomPoint.y = Math.abs(_currCenterPoint.y) - _panOffset.y;\n          _currPointsDistance = _startPointsDistance = _calculatePointsDistance(p, p2);\n        }\n      },\n      // Pointermove/touchmove/mousemove handler\n      _onDragMove = function (e) {\n        e.preventDefault();\n        if (_pointerEventEnabled) {\n          var pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n          if (pointerIndex > -1) {\n            var p = _currPointers[pointerIndex];\n            p.x = e.pageX;\n            p.y = e.pageY;\n          }\n        }\n        if (_isDragging) {\n          var touchesList = _getTouchPoints(e);\n          if (!_direction && !_moved && !_isZooming) {\n            if (_mainScrollPos.x !== _slideSize.x * _currPositionIndex) {\n              // if main scroll position is shifted – direction is always horizontal\n              _direction = 'h';\n            } else {\n              var diff = Math.abs(touchesList[0].x - _currPoint.x) - Math.abs(touchesList[0].y - _currPoint.y);\n              // check the direction of movement\n              if (Math.abs(diff) >= DIRECTION_CHECK_OFFSET) {\n                _direction = diff > 0 ? 'h' : 'v';\n                _currentPoints = touchesList;\n              }\n            }\n          } else {\n            _currentPoints = touchesList;\n          }\n        }\n      },\n      // \n      _renderMovement = function () {\n        if (!_currentPoints) {\n          return;\n        }\n        var numPoints = _currentPoints.length;\n        if (numPoints === 0) {\n          return;\n        }\n        _equalizePoints(p, _currentPoints[0]);\n        delta.x = p.x - _currPoint.x;\n        delta.y = p.y - _currPoint.y;\n        if (_isZooming && numPoints > 1) {\n          // Handle behaviour for more than 1 point\n\n          _currPoint.x = p.x;\n          _currPoint.y = p.y;\n\n          // check if one of two points changed\n          if (!delta.x && !delta.y && _isEqualPoints(_currentPoints[1], p2)) {\n            return;\n          }\n          _equalizePoints(p2, _currentPoints[1]);\n          if (!_zoomStarted) {\n            _zoomStarted = true;\n            _shout('zoomGestureStarted');\n          }\n\n          // Distance between two points\n          var pointsDistance = _calculatePointsDistance(p, p2);\n          var zoomLevel = _calculateZoomLevel(pointsDistance);\n\n          // slightly over the of initial zoom level\n          if (zoomLevel > self.currItem.initialZoomLevel + self.currItem.initialZoomLevel / 15) {\n            _wasOverInitialZoom = true;\n          }\n\n          // Apply the friction if zoom level is out of the bounds\n          var zoomFriction = 1,\n            minZoomLevel = _getMinZoomLevel(),\n            maxZoomLevel = _getMaxZoomLevel();\n          if (zoomLevel < minZoomLevel) {\n            if (_options.pinchToClose && !_wasOverInitialZoom && _startZoomLevel <= self.currItem.initialZoomLevel) {\n              // fade out background if zooming out\n              var minusDiff = minZoomLevel - zoomLevel;\n              var percent = 1 - minusDiff / (minZoomLevel / 1.2);\n              _applyBgOpacity(percent);\n              _shout('onPinchClose', percent);\n              _opacityChanged = true;\n            } else {\n              zoomFriction = (minZoomLevel - zoomLevel) / minZoomLevel;\n              if (zoomFriction > 1) {\n                zoomFriction = 1;\n              }\n              zoomLevel = minZoomLevel - zoomFriction * (minZoomLevel / 3);\n            }\n          } else if (zoomLevel > maxZoomLevel) {\n            // 1.5 - extra zoom level above the max. E.g. if max is x6, real max 6 + 1.5 = 7.5\n            zoomFriction = (zoomLevel - maxZoomLevel) / (minZoomLevel * 6);\n            if (zoomFriction > 1) {\n              zoomFriction = 1;\n            }\n            zoomLevel = maxZoomLevel + zoomFriction * minZoomLevel;\n          }\n          if (zoomFriction < 0) {\n            zoomFriction = 0;\n          }\n\n          // distance between touch points after friction is applied\n          _currPointsDistance = pointsDistance;\n\n          // _centerPoint - The point in the middle of two pointers\n          _findCenterOfPoints(p, p2, _centerPoint);\n\n          // paning with two pointers pressed\n          _currPanDist.x += _centerPoint.x - _currCenterPoint.x;\n          _currPanDist.y += _centerPoint.y - _currCenterPoint.y;\n          _equalizePoints(_currCenterPoint, _centerPoint);\n          _panOffset.x = _calculatePanOffset('x', zoomLevel);\n          _panOffset.y = _calculatePanOffset('y', zoomLevel);\n          _isZoomingIn = zoomLevel > _currZoomLevel;\n          _currZoomLevel = zoomLevel;\n          _applyCurrentZoomPan();\n        } else {\n          // handle behaviour for one point (dragging or panning)\n\n          if (!_direction) {\n            return;\n          }\n          if (_isFirstMove) {\n            _isFirstMove = false;\n\n            // subtract drag distance that was used during the detection direction  \n\n            if (Math.abs(delta.x) >= DIRECTION_CHECK_OFFSET) {\n              delta.x -= _currentPoints[0].x - _startPoint.x;\n            }\n            if (Math.abs(delta.y) >= DIRECTION_CHECK_OFFSET) {\n              delta.y -= _currentPoints[0].y - _startPoint.y;\n            }\n          }\n          _currPoint.x = p.x;\n          _currPoint.y = p.y;\n\n          // do nothing if pointers position hasn't changed\n          if (delta.x === 0 && delta.y === 0) {\n            return;\n          }\n          if (_direction === 'v' && _options.closeOnVerticalDrag) {\n            if (!_canPan()) {\n              _currPanDist.y += delta.y;\n              _panOffset.y += delta.y;\n              var opacityRatio = _calculateVerticalDragOpacityRatio();\n              _verticalDragInitiated = true;\n              _shout('onVerticalDrag', opacityRatio);\n              _applyBgOpacity(opacityRatio);\n              _applyCurrentZoomPan();\n              return;\n            }\n          }\n          _pushPosPoint(_getCurrentTime(), p.x, p.y);\n          _moved = true;\n          _currPanBounds = self.currItem.bounds;\n          var mainScrollChanged = _panOrMoveMainScroll('x', delta);\n          if (!mainScrollChanged) {\n            _panOrMoveMainScroll('y', delta);\n            _roundPoint(_panOffset);\n            _applyCurrentZoomPan();\n          }\n        }\n      },\n      // Pointerup/pointercancel/touchend/touchcancel/mouseup event handler\n      _onDragRelease = function (e) {\n        if (_features.isOldAndroid) {\n          if (_oldAndroidTouchEndTimeout && e.type === 'mouseup') {\n            return;\n          }\n\n          // on Android (v4.1, 4.2, 4.3 & possibly older) \n          // ghost mousedown/up event isn't preventable via e.preventDefault,\n          // which causes fake mousedown event\n          // so we block mousedown/up for 600ms\n          if (e.type.indexOf('touch') > -1) {\n            clearTimeout(_oldAndroidTouchEndTimeout);\n            _oldAndroidTouchEndTimeout = setTimeout(function () {\n              _oldAndroidTouchEndTimeout = 0;\n            }, 600);\n          }\n        }\n        _shout('pointerUp');\n        if (_preventDefaultEventBehaviour(e, false)) {\n          e.preventDefault();\n        }\n        var releasePoint;\n        if (_pointerEventEnabled) {\n          var pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n          if (pointerIndex > -1) {\n            releasePoint = _currPointers.splice(pointerIndex, 1)[0];\n            if (navigator.msPointerEnabled) {\n              var MSPOINTER_TYPES = {\n                4: 'mouse',\n                // event.MSPOINTER_TYPE_MOUSE\n                2: 'touch',\n                // event.MSPOINTER_TYPE_TOUCH \n                3: 'pen' // event.MSPOINTER_TYPE_PEN\n              };\n              releasePoint.type = MSPOINTER_TYPES[e.pointerType];\n              if (!releasePoint.type) {\n                releasePoint.type = e.pointerType || 'mouse';\n              }\n            } else {\n              releasePoint.type = e.pointerType || 'mouse';\n            }\n          }\n        }\n        var touchList = _getTouchPoints(e),\n          gestureType,\n          numPoints = touchList.length;\n        if (e.type === 'mouseup') {\n          numPoints = 0;\n        }\n\n        // Do nothing if there were 3 touch points or more\n        if (numPoints === 2) {\n          _currentPoints = null;\n          return true;\n        }\n\n        // if second pointer released\n        if (numPoints === 1) {\n          _equalizePoints(_startPoint, touchList[0]);\n        }\n\n        // pointer hasn't moved, send \"tap release\" point\n        if (numPoints === 0 && !_direction && !_mainScrollAnimating) {\n          if (!releasePoint) {\n            if (e.type === 'mouseup') {\n              releasePoint = {\n                x: e.pageX,\n                y: e.pageY,\n                type: 'mouse'\n              };\n            } else if (e.changedTouches && e.changedTouches[0]) {\n              releasePoint = {\n                x: e.changedTouches[0].pageX,\n                y: e.changedTouches[0].pageY,\n                type: 'touch'\n              };\n            }\n          }\n          _shout('touchRelease', e, releasePoint);\n        }\n\n        // Difference in time between releasing of two last touch points (zoom gesture)\n        var releaseTimeDiff = -1;\n\n        // Gesture completed, no pointers left\n        if (numPoints === 0) {\n          _isDragging = false;\n          framework.unbind(window, _upMoveEvents, self);\n          _stopDragUpdateLoop();\n          if (_isZooming) {\n            // Two points released at the same time\n            releaseTimeDiff = 0;\n          } else if (_lastReleaseTime !== -1) {\n            releaseTimeDiff = _getCurrentTime() - _lastReleaseTime;\n          }\n        }\n        _lastReleaseTime = numPoints === 1 ? _getCurrentTime() : -1;\n        if (releaseTimeDiff !== -1 && releaseTimeDiff < 150) {\n          gestureType = 'zoom';\n        } else {\n          gestureType = 'swipe';\n        }\n        if (_isZooming && numPoints < 2) {\n          _isZooming = false;\n\n          // Only second point released\n          if (numPoints === 1) {\n            gestureType = 'zoomPointerUp';\n          }\n          _shout('zoomGestureEnded');\n        }\n        _currentPoints = null;\n        if (!_moved && !_zoomStarted && !_mainScrollAnimating && !_verticalDragInitiated) {\n          // nothing to animate\n          return;\n        }\n        _stopAllAnimations();\n        if (!_releaseAnimData) {\n          _releaseAnimData = _initDragReleaseAnimationData();\n        }\n        _releaseAnimData.calculateSwipeSpeed('x');\n        if (_verticalDragInitiated) {\n          var opacityRatio = _calculateVerticalDragOpacityRatio();\n          if (opacityRatio < _options.verticalDragRange) {\n            self.close();\n          } else {\n            var initalPanY = _panOffset.y,\n              initialBgOpacity = _bgOpacity;\n            _animateProp('verticalDrag', 0, 1, 300, framework.easing.cubic.out, function (now) {\n              _panOffset.y = (self.currItem.initialPosition.y - initalPanY) * now + initalPanY;\n              _applyBgOpacity((1 - initialBgOpacity) * now + initialBgOpacity);\n              _applyCurrentZoomPan();\n            });\n            _shout('onVerticalDrag', 1);\n          }\n          return;\n        }\n\n        // main scroll \n        if ((_mainScrollShifted || _mainScrollAnimating) && numPoints === 0) {\n          var itemChanged = _finishSwipeMainScrollGesture(gestureType, _releaseAnimData);\n          if (itemChanged) {\n            return;\n          }\n          gestureType = 'zoomPointerUp';\n        }\n\n        // prevent zoom/pan animation when main scroll animation runs\n        if (_mainScrollAnimating) {\n          return;\n        }\n\n        // Complete simple zoom gesture (reset zoom level if it's out of the bounds)  \n        if (gestureType !== 'swipe') {\n          _completeZoomGesture();\n          return;\n        }\n\n        // Complete pan gesture if main scroll is not shifted, and it's possible to pan current image\n        if (!_mainScrollShifted && _currZoomLevel > self.currItem.fitRatio) {\n          _completePanGesture(_releaseAnimData);\n        }\n      },\n      // Returns object with data about gesture\n      // It's created only once and then reused\n      _initDragReleaseAnimationData = function () {\n        // temp local vars\n        var lastFlickDuration, tempReleasePos;\n\n        // s = this\n        var s = {\n          lastFlickOffset: {},\n          lastFlickDist: {},\n          lastFlickSpeed: {},\n          slowDownRatio: {},\n          slowDownRatioReverse: {},\n          speedDecelerationRatio: {},\n          speedDecelerationRatioAbs: {},\n          distanceOffset: {},\n          backAnimDestination: {},\n          backAnimStarted: {},\n          calculateSwipeSpeed: function (axis) {\n            if (_posPoints.length > 1) {\n              lastFlickDuration = _getCurrentTime() - _gestureCheckSpeedTime + 50;\n              tempReleasePos = _posPoints[_posPoints.length - 2][axis];\n            } else {\n              lastFlickDuration = _getCurrentTime() - _gestureStartTime; // total gesture duration\n              tempReleasePos = _startPoint[axis];\n            }\n            s.lastFlickOffset[axis] = _currPoint[axis] - tempReleasePos;\n            s.lastFlickDist[axis] = Math.abs(s.lastFlickOffset[axis]);\n            if (s.lastFlickDist[axis] > 20) {\n              s.lastFlickSpeed[axis] = s.lastFlickOffset[axis] / lastFlickDuration;\n            } else {\n              s.lastFlickSpeed[axis] = 0;\n            }\n            if (Math.abs(s.lastFlickSpeed[axis]) < 0.1) {\n              s.lastFlickSpeed[axis] = 0;\n            }\n            s.slowDownRatio[axis] = 0.95;\n            s.slowDownRatioReverse[axis] = 1 - s.slowDownRatio[axis];\n            s.speedDecelerationRatio[axis] = 1;\n          },\n          calculateOverBoundsAnimOffset: function (axis, speed) {\n            if (!s.backAnimStarted[axis]) {\n              if (_panOffset[axis] > _currPanBounds.min[axis]) {\n                s.backAnimDestination[axis] = _currPanBounds.min[axis];\n              } else if (_panOffset[axis] < _currPanBounds.max[axis]) {\n                s.backAnimDestination[axis] = _currPanBounds.max[axis];\n              }\n              if (s.backAnimDestination[axis] !== undefined) {\n                s.slowDownRatio[axis] = 0.7;\n                s.slowDownRatioReverse[axis] = 1 - s.slowDownRatio[axis];\n                if (s.speedDecelerationRatioAbs[axis] < 0.05) {\n                  s.lastFlickSpeed[axis] = 0;\n                  s.backAnimStarted[axis] = true;\n                  _animateProp('bounceZoomPan' + axis, _panOffset[axis], s.backAnimDestination[axis], speed || 300, framework.easing.sine.out, function (pos) {\n                    _panOffset[axis] = pos;\n                    _applyCurrentZoomPan();\n                  });\n                }\n              }\n            }\n          },\n          // Reduces the speed by slowDownRatio (per 10ms)\n          calculateAnimOffset: function (axis) {\n            if (!s.backAnimStarted[axis]) {\n              s.speedDecelerationRatio[axis] = s.speedDecelerationRatio[axis] * (s.slowDownRatio[axis] + s.slowDownRatioReverse[axis] - s.slowDownRatioReverse[axis] * s.timeDiff / 10);\n              s.speedDecelerationRatioAbs[axis] = Math.abs(s.lastFlickSpeed[axis] * s.speedDecelerationRatio[axis]);\n              s.distanceOffset[axis] = s.lastFlickSpeed[axis] * s.speedDecelerationRatio[axis] * s.timeDiff;\n              _panOffset[axis] += s.distanceOffset[axis];\n            }\n          },\n          panAnimLoop: function () {\n            if (_animations.zoomPan) {\n              _animations.zoomPan.raf = _requestAF(s.panAnimLoop);\n              s.now = _getCurrentTime();\n              s.timeDiff = s.now - s.lastNow;\n              s.lastNow = s.now;\n              s.calculateAnimOffset('x');\n              s.calculateAnimOffset('y');\n              _applyCurrentZoomPan();\n              s.calculateOverBoundsAnimOffset('x');\n              s.calculateOverBoundsAnimOffset('y');\n              if (s.speedDecelerationRatioAbs.x < 0.05 && s.speedDecelerationRatioAbs.y < 0.05) {\n                // round pan position\n                _panOffset.x = Math.round(_panOffset.x);\n                _panOffset.y = Math.round(_panOffset.y);\n                _applyCurrentZoomPan();\n                _stopAnimation('zoomPan');\n                return;\n              }\n            }\n          }\n        };\n        return s;\n      },\n      _completePanGesture = function (animData) {\n        // calculate swipe speed for Y axis (paanning)\n        animData.calculateSwipeSpeed('y');\n        _currPanBounds = self.currItem.bounds;\n        animData.backAnimDestination = {};\n        animData.backAnimStarted = {};\n\n        // Avoid acceleration animation if speed is too low\n        if (Math.abs(animData.lastFlickSpeed.x) <= 0.05 && Math.abs(animData.lastFlickSpeed.y) <= 0.05) {\n          animData.speedDecelerationRatioAbs.x = animData.speedDecelerationRatioAbs.y = 0;\n\n          // Run pan drag release animation. E.g. if you drag image and release finger without momentum.\n          animData.calculateOverBoundsAnimOffset('x');\n          animData.calculateOverBoundsAnimOffset('y');\n          return true;\n        }\n\n        // Animation loop that controls the acceleration after pan gesture ends\n        _registerStartAnimation('zoomPan');\n        animData.lastNow = _getCurrentTime();\n        animData.panAnimLoop();\n      },\n      _finishSwipeMainScrollGesture = function (gestureType, _releaseAnimData) {\n        var itemChanged;\n        if (!_mainScrollAnimating) {\n          _currZoomedItemIndex = _currentItemIndex;\n        }\n        var itemsDiff;\n        if (gestureType === 'swipe') {\n          var totalShiftDist = _currPoint.x - _startPoint.x,\n            isFastLastFlick = _releaseAnimData.lastFlickDist.x < 10;\n\n          // if container is shifted for more than MIN_SWIPE_DISTANCE, \n          // and last flick gesture was in right direction\n          if (totalShiftDist > MIN_SWIPE_DISTANCE && (isFastLastFlick || _releaseAnimData.lastFlickOffset.x > 20)) {\n            // go to prev item\n            itemsDiff = -1;\n          } else if (totalShiftDist < -MIN_SWIPE_DISTANCE && (isFastLastFlick || _releaseAnimData.lastFlickOffset.x < -20)) {\n            // go to next item\n            itemsDiff = 1;\n          }\n        }\n        var nextCircle;\n        if (itemsDiff) {\n          _currentItemIndex += itemsDiff;\n          if (_currentItemIndex < 0) {\n            _currentItemIndex = _options.loop ? _getNumItems() - 1 : 0;\n            nextCircle = true;\n          } else if (_currentItemIndex >= _getNumItems()) {\n            _currentItemIndex = _options.loop ? 0 : _getNumItems() - 1;\n            nextCircle = true;\n          }\n          if (!nextCircle || _options.loop) {\n            _indexDiff += itemsDiff;\n            _currPositionIndex -= itemsDiff;\n            itemChanged = true;\n          }\n        }\n        var animateToX = _slideSize.x * _currPositionIndex;\n        var animateToDist = Math.abs(animateToX - _mainScrollPos.x);\n        var finishAnimDuration;\n        if (!itemChanged && animateToX > _mainScrollPos.x !== _releaseAnimData.lastFlickSpeed.x > 0) {\n          // \"return to current\" duration, e.g. when dragging from slide 0 to -1\n          finishAnimDuration = 333;\n        } else {\n          finishAnimDuration = Math.abs(_releaseAnimData.lastFlickSpeed.x) > 0 ? animateToDist / Math.abs(_releaseAnimData.lastFlickSpeed.x) : 333;\n          finishAnimDuration = Math.min(finishAnimDuration, 400);\n          finishAnimDuration = Math.max(finishAnimDuration, 250);\n        }\n        if (_currZoomedItemIndex === _currentItemIndex) {\n          itemChanged = false;\n        }\n        _mainScrollAnimating = true;\n        _shout('mainScrollAnimStart');\n        _animateProp('mainScroll', _mainScrollPos.x, animateToX, finishAnimDuration, framework.easing.cubic.out, _moveMainScroll, function () {\n          _stopAllAnimations();\n          _mainScrollAnimating = false;\n          _currZoomedItemIndex = -1;\n          if (itemChanged || _currZoomedItemIndex !== _currentItemIndex) {\n            self.updateCurrItem();\n          }\n          _shout('mainScrollAnimComplete');\n        });\n        if (itemChanged) {\n          self.updateCurrItem(true);\n        }\n        return itemChanged;\n      },\n      _calculateZoomLevel = function (touchesDistance) {\n        return 1 / _startPointsDistance * touchesDistance * _startZoomLevel;\n      },\n      // Resets zoom if it's out of bounds\n      _completeZoomGesture = function () {\n        var destZoomLevel = _currZoomLevel,\n          minZoomLevel = _getMinZoomLevel(),\n          maxZoomLevel = _getMaxZoomLevel();\n        if (_currZoomLevel < minZoomLevel) {\n          destZoomLevel = minZoomLevel;\n        } else if (_currZoomLevel > maxZoomLevel) {\n          destZoomLevel = maxZoomLevel;\n        }\n        var destOpacity = 1,\n          onUpdate,\n          initialOpacity = _bgOpacity;\n        if (_opacityChanged && !_isZoomingIn && !_wasOverInitialZoom && _currZoomLevel < minZoomLevel) {\n          //_closedByScroll = true;\n          self.close();\n          return true;\n        }\n        if (_opacityChanged) {\n          onUpdate = function (now) {\n            _applyBgOpacity((destOpacity - initialOpacity) * now + initialOpacity);\n          };\n        }\n        self.zoomTo(destZoomLevel, 0, 200, framework.easing.cubic.out, onUpdate);\n        return true;\n      };\n    _registerModule('Gestures', {\n      publicMethods: {\n        initGestures: function () {\n          // helper function that builds touch/pointer/mouse events\n          var addEventNames = function (pref, down, move, up, cancel) {\n            _dragStartEvent = pref + down;\n            _dragMoveEvent = pref + move;\n            _dragEndEvent = pref + up;\n            if (cancel) {\n              _dragCancelEvent = pref + cancel;\n            } else {\n              _dragCancelEvent = '';\n            }\n          };\n          _pointerEventEnabled = _features.pointerEvent;\n          if (_pointerEventEnabled && _features.touch) {\n            // we don't need touch events, if browser supports pointer events\n            _features.touch = false;\n          }\n          if (_pointerEventEnabled) {\n            if (navigator.msPointerEnabled) {\n              // IE10 pointer events are case-sensitive\n              addEventNames('MSPointer', 'Down', 'Move', 'Up', 'Cancel');\n            } else {\n              addEventNames('pointer', 'down', 'move', 'up', 'cancel');\n            }\n          } else if (_features.touch) {\n            addEventNames('touch', 'start', 'move', 'end', 'cancel');\n            _likelyTouchDevice = true;\n          } else {\n            addEventNames('mouse', 'down', 'move', 'up');\n          }\n          _upMoveEvents = _dragMoveEvent + ' ' + _dragEndEvent + ' ' + _dragCancelEvent;\n          _downEvents = _dragStartEvent;\n          if (_pointerEventEnabled && !_likelyTouchDevice) {\n            _likelyTouchDevice = navigator.maxTouchPoints > 1 || navigator.msMaxTouchPoints > 1;\n          }\n          // make variable public\n          self.likelyTouchDevice = _likelyTouchDevice;\n          _globalEventHandlers[_dragStartEvent] = _onDragStart;\n          _globalEventHandlers[_dragMoveEvent] = _onDragMove;\n          _globalEventHandlers[_dragEndEvent] = _onDragRelease; // the Kraken\n\n          if (_dragCancelEvent) {\n            _globalEventHandlers[_dragCancelEvent] = _globalEventHandlers[_dragEndEvent];\n          }\n\n          // Bind mouse events on device with detected hardware touch support, in case it supports multiple types of input.\n          if (_features.touch) {\n            _downEvents += ' mousedown';\n            _upMoveEvents += ' mousemove mouseup';\n            _globalEventHandlers.mousedown = _globalEventHandlers[_dragStartEvent];\n            _globalEventHandlers.mousemove = _globalEventHandlers[_dragMoveEvent];\n            _globalEventHandlers.mouseup = _globalEventHandlers[_dragEndEvent];\n          }\n          if (!_likelyTouchDevice) {\n            // don't allow pan to next slide from zoomed state on Desktop\n            _options.allowPanToNext = false;\n          }\n        }\n      }\n    });\n\n    /*>>gestures*/\n\n    /*>>show-hide-transition*/\n    /**\n     * show-hide-transition.js:\n     *\n     * Manages initial opening or closing transition.\n     *\n     * If you're not planning to use transition for gallery at all,\n     * you may set options hideAnimationDuration and showAnimationDuration to 0,\n     * and just delete startAnimation function.\n     * \n     */\n\n    var _showOrHideTimeout,\n      _showOrHide = function (item, img, out, completeFn) {\n        if (_showOrHideTimeout) {\n          clearTimeout(_showOrHideTimeout);\n        }\n        _initialZoomRunning = true;\n        _initialContentSet = true;\n\n        // dimensions of small thumbnail {x:,y:,w:}.\n        // Height is optional, as calculated based on large image.\n        var thumbBounds;\n        if (item.initialLayout) {\n          thumbBounds = item.initialLayout;\n          item.initialLayout = null;\n        } else {\n          thumbBounds = _options.getThumbBoundsFn && _options.getThumbBoundsFn(_currentItemIndex);\n        }\n        var duration = out ? _options.hideAnimationDuration : _options.showAnimationDuration;\n        var onComplete = function () {\n          _stopAnimation('initialZoom');\n          if (!out) {\n            _applyBgOpacity(1);\n            if (img) {\n              img.style.display = 'block';\n            }\n            framework.addClass(template, 'pswp--animated-in');\n            _shout('initialZoom' + (out ? 'OutEnd' : 'InEnd'));\n          } else {\n            self.template.removeAttribute('style');\n            self.bg.removeAttribute('style');\n          }\n          if (completeFn) {\n            completeFn();\n          }\n          _initialZoomRunning = false;\n        };\n\n        // if bounds aren't provided, just open gallery without animation\n        if (!duration || !thumbBounds || thumbBounds.x === undefined) {\n          _shout('initialZoom' + (out ? 'Out' : 'In'));\n          _currZoomLevel = item.initialZoomLevel;\n          _equalizePoints(_panOffset, item.initialPosition);\n          _applyCurrentZoomPan();\n          template.style.opacity = out ? 0 : 1;\n          _applyBgOpacity(1);\n          if (duration) {\n            setTimeout(function () {\n              onComplete();\n            }, duration);\n          } else {\n            onComplete();\n          }\n          return;\n        }\n        var startAnimation = function () {\n          var closeWithRaf = _closedByScroll,\n            fadeEverything = !self.currItem.src || self.currItem.loadError || _options.showHideOpacity;\n\n          // apply hw-acceleration to image\n          if (item.miniImg) {\n            item.miniImg.style.webkitBackfaceVisibility = 'hidden';\n          }\n          if (!out) {\n            _currZoomLevel = thumbBounds.w / item.w;\n            _panOffset.x = thumbBounds.x;\n            _panOffset.y = thumbBounds.y - _initalWindowScrollY;\n            self[fadeEverything ? 'template' : 'bg'].style.opacity = 0.001;\n            _applyCurrentZoomPan();\n          }\n          _registerStartAnimation('initialZoom');\n          if (out && !closeWithRaf) {\n            framework.removeClass(template, 'pswp--animated-in');\n          }\n          if (fadeEverything) {\n            if (out) {\n              framework[(closeWithRaf ? 'remove' : 'add') + 'Class'](template, 'pswp--animate_opacity');\n            } else {\n              setTimeout(function () {\n                framework.addClass(template, 'pswp--animate_opacity');\n              }, 30);\n            }\n          }\n          _showOrHideTimeout = setTimeout(function () {\n            _shout('initialZoom' + (out ? 'Out' : 'In'));\n            if (!out) {\n              // \"in\" animation always uses CSS transitions (instead of rAF).\n              // CSS transition work faster here, \n              // as developer may also want to animate other things, \n              // like ui on top of sliding area, which can be animated just via CSS\n\n              _currZoomLevel = item.initialZoomLevel;\n              _equalizePoints(_panOffset, item.initialPosition);\n              _applyCurrentZoomPan();\n              _applyBgOpacity(1);\n              if (fadeEverything) {\n                template.style.opacity = 1;\n              } else {\n                _applyBgOpacity(1);\n              }\n              _showOrHideTimeout = setTimeout(onComplete, duration + 20);\n            } else {\n              // \"out\" animation uses rAF only when PhotoSwipe is closed by browser scroll, to recalculate position\n              var destZoomLevel = thumbBounds.w / item.w,\n                initialPanOffset = {\n                  x: _panOffset.x,\n                  y: _panOffset.y\n                },\n                initialZoomLevel = _currZoomLevel,\n                initalBgOpacity = _bgOpacity,\n                onUpdate = function (now) {\n                  if (now === 1) {\n                    _currZoomLevel = destZoomLevel;\n                    _panOffset.x = thumbBounds.x;\n                    _panOffset.y = thumbBounds.y - _currentWindowScrollY;\n                  } else {\n                    _currZoomLevel = (destZoomLevel - initialZoomLevel) * now + initialZoomLevel;\n                    _panOffset.x = (thumbBounds.x - initialPanOffset.x) * now + initialPanOffset.x;\n                    _panOffset.y = (thumbBounds.y - _currentWindowScrollY - initialPanOffset.y) * now + initialPanOffset.y;\n                  }\n                  _applyCurrentZoomPan();\n                  if (fadeEverything) {\n                    template.style.opacity = 1 - now;\n                  } else {\n                    _applyBgOpacity(initalBgOpacity - now * initalBgOpacity);\n                  }\n                };\n              if (closeWithRaf) {\n                _animateProp('initialZoom', 0, 1, duration, framework.easing.cubic.out, onUpdate, onComplete);\n              } else {\n                onUpdate(1);\n                _showOrHideTimeout = setTimeout(onComplete, duration + 20);\n              }\n            }\n          }, out ? 25 : 90); // Main purpose of this delay is to give browser time to paint and\n          // create composite layers of PhotoSwipe UI parts (background, controls, caption, arrows).\n          // Which avoids lag at the beginning of scale transition.\n        };\n        startAnimation();\n      };\n\n    /*>>show-hide-transition*/\n\n    /*>>items-controller*/\n    /**\n    *\n    * Controller manages gallery items, their dimensions, and their content.\n    * \n    */\n\n    var _items,\n      _tempPanAreaSize = {},\n      _imagesToAppendPool = [],\n      _initialContentSet,\n      _initialZoomRunning,\n      _controllerDefaultOptions = {\n        index: 0,\n        errorMsg: '<div class=\"pswp__error-msg\"><a href=\"%url%\" target=\"_blank\">The image</a> could not be loaded.</div>',\n        forceProgressiveLoading: false,\n        // TODO\n        preload: [1, 1],\n        getNumItemsFn: function () {\n          return _items.length;\n        }\n      };\n    var _getItemAt,\n      _getNumItems,\n      _initialIsLoop,\n      _getZeroBounds = function () {\n        return {\n          center: {\n            x: 0,\n            y: 0\n          },\n          max: {\n            x: 0,\n            y: 0\n          },\n          min: {\n            x: 0,\n            y: 0\n          }\n        };\n      },\n      _calculateSingleItemPanBounds = function (item, realPanElementW, realPanElementH) {\n        var bounds = item.bounds;\n\n        // position of element when it's centered\n        bounds.center.x = Math.round((_tempPanAreaSize.x - realPanElementW) / 2);\n        bounds.center.y = Math.round((_tempPanAreaSize.y - realPanElementH) / 2) + item.vGap.top;\n\n        // maximum pan position\n        bounds.max.x = realPanElementW > _tempPanAreaSize.x ? Math.round(_tempPanAreaSize.x - realPanElementW) : bounds.center.x;\n        bounds.max.y = realPanElementH > _tempPanAreaSize.y ? Math.round(_tempPanAreaSize.y - realPanElementH) + item.vGap.top : bounds.center.y;\n\n        // minimum pan position\n        bounds.min.x = realPanElementW > _tempPanAreaSize.x ? 0 : bounds.center.x;\n        bounds.min.y = realPanElementH > _tempPanAreaSize.y ? item.vGap.top : bounds.center.y;\n      },\n      _calculateItemSize = function (item, viewportSize, zoomLevel) {\n        if (item.src && !item.loadError) {\n          var isInitial = !zoomLevel;\n          if (isInitial) {\n            if (!item.vGap) {\n              item.vGap = {\n                top: 0,\n                bottom: 0\n              };\n            }\n            // allows overriding vertical margin for individual items\n            _shout('parseVerticalMargin', item);\n          }\n          _tempPanAreaSize.x = viewportSize.x;\n          _tempPanAreaSize.y = viewportSize.y - item.vGap.top - item.vGap.bottom;\n          if (isInitial) {\n            var hRatio = _tempPanAreaSize.x / item.w;\n            var vRatio = _tempPanAreaSize.y / item.h;\n            item.fitRatio = hRatio < vRatio ? hRatio : vRatio;\n            //item.fillRatio = hRatio > vRatio ? hRatio : vRatio;\n\n            var scaleMode = _options.scaleMode;\n            if (scaleMode === 'orig') {\n              zoomLevel = 1;\n            } else if (scaleMode === 'fit') {\n              zoomLevel = item.fitRatio;\n            }\n            if (zoomLevel > 1) {\n              zoomLevel = 1;\n            }\n            item.initialZoomLevel = zoomLevel;\n            if (!item.bounds) {\n              // reuse bounds object\n              item.bounds = _getZeroBounds();\n            }\n          }\n          if (!zoomLevel) {\n            return;\n          }\n          _calculateSingleItemPanBounds(item, item.w * zoomLevel, item.h * zoomLevel);\n          if (isInitial && zoomLevel === item.initialZoomLevel) {\n            item.initialPosition = item.bounds.center;\n          }\n          return item.bounds;\n        } else {\n          item.w = item.h = 0;\n          item.initialZoomLevel = item.fitRatio = 1;\n          item.bounds = _getZeroBounds();\n          item.initialPosition = item.bounds.center;\n\n          // if it's not image, we return zero bounds (content is not zoomable)\n          return item.bounds;\n        }\n      },\n      _appendImage = function (index, item, baseDiv, img, preventAnimation, keepPlaceholder) {\n        if (item.loadError) {\n          return;\n        }\n        if (img) {\n          item.imageAppended = true;\n          _setImageSize(item, img, item === self.currItem && _renderMaxResolution);\n          baseDiv.appendChild(img);\n          if (keepPlaceholder) {\n            setTimeout(function () {\n              if (item && item.loaded && item.placeholder) {\n                item.placeholder.style.display = 'none';\n                item.placeholder = null;\n              }\n            }, 500);\n          }\n        }\n      },\n      _preloadImage = function (item) {\n        item.loading = true;\n        item.loaded = false;\n        var img = item.img = framework.createEl('pswp__img', 'img');\n        var onComplete = function () {\n          item.loading = false;\n          item.loaded = true;\n          if (item.loadComplete) {\n            item.loadComplete(item);\n          } else {\n            item.img = null; // no need to store image object\n          }\n          img.onload = img.onerror = null;\n          img = null;\n        };\n        img.onload = onComplete;\n        img.onerror = function () {\n          item.loadError = true;\n          onComplete();\n        };\n        img.src = item.src; // + '?a=' + Math.random();\n\n        return img;\n      },\n      _checkForError = function (item, cleanUp) {\n        if (item.src && item.loadError && item.container) {\n          if (cleanUp) {\n            item.container.innerHTML = '';\n          }\n          item.container.innerHTML = _options.errorMsg.replace('%url%', item.src);\n          return true;\n        }\n      },\n      _setImageSize = function (item, img, maxRes) {\n        if (!item.src) {\n          return;\n        }\n        if (!img) {\n          img = item.container.lastChild;\n        }\n        var w = maxRes ? item.w : Math.round(item.w * item.fitRatio),\n          h = maxRes ? item.h : Math.round(item.h * item.fitRatio);\n        if (item.placeholder && !item.loaded) {\n          item.placeholder.style.width = w + 'px';\n          item.placeholder.style.height = h + 'px';\n        }\n        img.style.width = w + 'px';\n        img.style.height = h + 'px';\n      },\n      _appendImagesPool = function () {\n        if (_imagesToAppendPool.length) {\n          var poolItem;\n          for (var i = 0; i < _imagesToAppendPool.length; i++) {\n            poolItem = _imagesToAppendPool[i];\n            if (poolItem.holder.index === poolItem.index) {\n              _appendImage(poolItem.index, poolItem.item, poolItem.baseDiv, poolItem.img, false, poolItem.clearPlaceholder);\n            }\n          }\n          _imagesToAppendPool = [];\n        }\n      };\n    _registerModule('Controller', {\n      publicMethods: {\n        lazyLoadItem: function (index) {\n          index = _getLoopedId(index);\n          var item = _getItemAt(index);\n          if (!item || (item.loaded || item.loading) && !_itemsNeedUpdate) {\n            return;\n          }\n          _shout('gettingData', index, item);\n          if (!item.src) {\n            return;\n          }\n          _preloadImage(item);\n        },\n        initController: function () {\n          framework.extend(_options, _controllerDefaultOptions, true);\n          self.items = _items = items;\n          _getItemAt = self.getItemAt;\n          _getNumItems = _options.getNumItemsFn; //self.getNumItems;\n\n          _initialIsLoop = _options.loop;\n          if (_getNumItems() < 3) {\n            _options.loop = false; // disable loop if less then 3 items\n          }\n          _listen('beforeChange', function (diff) {\n            var p = _options.preload,\n              isNext = diff === null ? true : diff >= 0,\n              preloadBefore = Math.min(p[0], _getNumItems()),\n              preloadAfter = Math.min(p[1], _getNumItems()),\n              i;\n            for (i = 1; i <= (isNext ? preloadAfter : preloadBefore); i++) {\n              self.lazyLoadItem(_currentItemIndex + i);\n            }\n            for (i = 1; i <= (isNext ? preloadBefore : preloadAfter); i++) {\n              self.lazyLoadItem(_currentItemIndex - i);\n            }\n          });\n          _listen('initialLayout', function () {\n            self.currItem.initialLayout = _options.getThumbBoundsFn && _options.getThumbBoundsFn(_currentItemIndex);\n          });\n          _listen('mainScrollAnimComplete', _appendImagesPool);\n          _listen('initialZoomInEnd', _appendImagesPool);\n          _listen('destroy', function () {\n            var item;\n            for (var i = 0; i < _items.length; i++) {\n              item = _items[i];\n              // remove reference to DOM elements, for GC\n              if (item.container) {\n                item.container = null;\n              }\n              if (item.placeholder) {\n                item.placeholder = null;\n              }\n              if (item.img) {\n                item.img = null;\n              }\n              if (item.preloader) {\n                item.preloader = null;\n              }\n              if (item.loadError) {\n                item.loaded = item.loadError = false;\n              }\n            }\n            _imagesToAppendPool = null;\n          });\n        },\n        getItemAt: function (index) {\n          if (index >= 0) {\n            return _items[index] !== undefined ? _items[index] : false;\n          }\n          return false;\n        },\n        allowProgressiveImg: function () {\n          // 1. Progressive image loading isn't working on webkit/blink \n          //    when hw-acceleration (e.g. translateZ) is applied to IMG element.\n          //    That's why in PhotoSwipe parent element gets zoom transform, not image itself.\n          //    \n          // 2. Progressive image loading sometimes blinks in webkit/blink when applying animation to parent element.\n          //    That's why it's disabled on touch devices (mainly because of swipe transition)\n          //    \n          // 3. Progressive image loading sometimes doesn't work in IE (up to 11).\n\n          // Don't allow progressive loading on non-large touch devices\n          return _options.forceProgressiveLoading || !_likelyTouchDevice || _options.mouseUsed || screen.width > 1200;\n          // 1200 - to eliminate touch devices with large screen (like Chromebook Pixel)\n        },\n        setContent: function (holder, index) {\n          if (_options.loop) {\n            index = _getLoopedId(index);\n          }\n          var prevItem = self.getItemAt(holder.index);\n          if (prevItem) {\n            prevItem.container = null;\n          }\n          var item = self.getItemAt(index),\n            img;\n          if (!item) {\n            holder.el.innerHTML = '';\n            return;\n          }\n\n          // allow to override data\n          _shout('gettingData', index, item);\n          holder.index = index;\n          holder.item = item;\n\n          // base container DIV is created only once for each of 3 holders\n          var baseDiv = item.container = framework.createEl('pswp__zoom-wrap');\n          if (!item.src && item.html) {\n            if (item.html.tagName) {\n              baseDiv.appendChild(item.html);\n            } else {\n              baseDiv.innerHTML = item.html;\n            }\n          }\n          _checkForError(item);\n          _calculateItemSize(item, _viewportSize);\n          if (item.src && !item.loadError && !item.loaded) {\n            item.loadComplete = function (item) {\n              // gallery closed before image finished loading\n              if (!_isOpen) {\n                return;\n              }\n\n              // check if holder hasn't changed while image was loading\n              if (holder && holder.index === index) {\n                if (_checkForError(item, true)) {\n                  item.loadComplete = item.img = null;\n                  _calculateItemSize(item, _viewportSize);\n                  _applyZoomPanToItem(item);\n                  if (holder.index === _currentItemIndex) {\n                    // recalculate dimensions\n                    self.updateCurrZoomItem();\n                  }\n                  return;\n                }\n                if (!item.imageAppended) {\n                  if (_features.transform && (_mainScrollAnimating || _initialZoomRunning)) {\n                    _imagesToAppendPool.push({\n                      item: item,\n                      baseDiv: baseDiv,\n                      img: item.img,\n                      index: index,\n                      holder: holder,\n                      clearPlaceholder: true\n                    });\n                  } else {\n                    _appendImage(index, item, baseDiv, item.img, _mainScrollAnimating || _initialZoomRunning, true);\n                  }\n                } else {\n                  // remove preloader & mini-img\n                  if (!_initialZoomRunning && item.placeholder) {\n                    item.placeholder.style.display = 'none';\n                    item.placeholder = null;\n                  }\n                }\n              }\n              item.loadComplete = null;\n              item.img = null; // no need to store image element after it's added\n\n              _shout('imageLoadComplete', index, item);\n            };\n            if (framework.features.transform) {\n              var placeholderClassName = 'pswp__img pswp__img--placeholder';\n              placeholderClassName += item.msrc ? '' : ' pswp__img--placeholder--blank';\n              var placeholder = framework.createEl(placeholderClassName, item.msrc ? 'img' : '');\n              if (item.msrc) {\n                placeholder.src = item.msrc;\n              }\n              _setImageSize(item, placeholder);\n              baseDiv.appendChild(placeholder);\n              item.placeholder = placeholder;\n            }\n            if (!item.loading) {\n              _preloadImage(item);\n            }\n            if (self.allowProgressiveImg()) {\n              // just append image\n              if (!_initialContentSet && _features.transform) {\n                _imagesToAppendPool.push({\n                  item: item,\n                  baseDiv: baseDiv,\n                  img: item.img,\n                  index: index,\n                  holder: holder\n                });\n              } else {\n                _appendImage(index, item, baseDiv, item.img, true, true);\n              }\n            }\n          } else if (item.src && !item.loadError) {\n            // image object is created every time, due to bugs of image loading & delay when switching images\n            img = framework.createEl('pswp__img', 'img');\n            img.style.opacity = 1;\n            img.src = item.src;\n            _setImageSize(item, img);\n            _appendImage(index, item, baseDiv, img, true);\n          }\n          if (!_initialContentSet && index === _currentItemIndex) {\n            _currZoomElementStyle = baseDiv.style;\n            _showOrHide(item, img || item.img);\n          } else {\n            _applyZoomPanToItem(item);\n          }\n          holder.el.innerHTML = '';\n          holder.el.appendChild(baseDiv);\n        },\n        cleanSlide: function (item) {\n          if (item.img) {\n            item.img.onload = item.img.onerror = null;\n          }\n          item.loaded = item.loading = item.img = item.imageAppended = false;\n        }\n      }\n    });\n\n    /*>>items-controller*/\n\n    /*>>tap*/\n    /**\n     * tap.js:\n     *\n     * Displatches tap and double-tap events.\n     * \n     */\n\n    var tapTimer,\n      tapReleasePoint = {},\n      _dispatchTapEvent = function (origEvent, releasePoint, pointerType) {\n        var e = document.createEvent('CustomEvent'),\n          eDetail = {\n            origEvent: origEvent,\n            target: origEvent.target,\n            releasePoint: releasePoint,\n            pointerType: pointerType || 'touch'\n          };\n        e.initCustomEvent('pswpTap', true, true, eDetail);\n        origEvent.target.dispatchEvent(e);\n      };\n    _registerModule('Tap', {\n      publicMethods: {\n        initTap: function () {\n          _listen('firstTouchStart', self.onTapStart);\n          _listen('touchRelease', self.onTapRelease);\n          _listen('destroy', function () {\n            tapReleasePoint = {};\n            tapTimer = null;\n          });\n        },\n        onTapStart: function (touchList) {\n          if (touchList.length > 1) {\n            clearTimeout(tapTimer);\n            tapTimer = null;\n          }\n        },\n        onTapRelease: function (e, releasePoint) {\n          if (!releasePoint) {\n            return;\n          }\n          if (!_moved && !_isMultitouch && !_numAnimations) {\n            var p0 = releasePoint;\n            if (tapTimer) {\n              clearTimeout(tapTimer);\n              tapTimer = null;\n\n              // Check if taped on the same place\n              if (_isNearbyPoints(p0, tapReleasePoint)) {\n                _shout('doubleTap', p0);\n                return;\n              }\n            }\n            if (releasePoint.type === 'mouse') {\n              _dispatchTapEvent(e, releasePoint, 'mouse');\n              return;\n            }\n            var clickedTagName = e.target.tagName.toUpperCase();\n            // avoid double tap delay on buttons and elements that have class pswp__single-tap\n            if (clickedTagName === 'BUTTON' || framework.hasClass(e.target, 'pswp__single-tap')) {\n              _dispatchTapEvent(e, releasePoint);\n              return;\n            }\n            _equalizePoints(tapReleasePoint, p0);\n            tapTimer = setTimeout(function () {\n              _dispatchTapEvent(e, releasePoint);\n              tapTimer = null;\n            }, 300);\n          }\n        }\n      }\n    });\n\n    /*>>tap*/\n\n    /*>>desktop-zoom*/\n    /**\n     *\n     * desktop-zoom.js:\n     *\n     * - Binds mousewheel event for paning zoomed image.\n     * - Manages \"dragging\", \"zoomed-in\", \"zoom-out\" classes.\n     *   (which are used for cursors and zoom icon)\n     * - Adds toggleDesktopZoom function.\n     * \n     */\n\n    var _wheelDelta;\n    _registerModule('DesktopZoom', {\n      publicMethods: {\n        initDesktopZoom: function () {\n          if (_oldIE) {\n            // no zoom for old IE (<=8)\n            return;\n          }\n          if (_likelyTouchDevice) {\n            // if detected hardware touch support, we wait until mouse is used,\n            // and only then apply desktop-zoom features\n            _listen('mouseUsed', function () {\n              self.setupDesktopZoom();\n            });\n          } else {\n            self.setupDesktopZoom(true);\n          }\n        },\n        setupDesktopZoom: function (onInit) {\n          _wheelDelta = {};\n          var events = 'wheel mousewheel DOMMouseScroll';\n          _listen('bindEvents', function () {\n            framework.bind(template, events, self.handleMouseWheel);\n          });\n          _listen('unbindEvents', function () {\n            if (_wheelDelta) {\n              framework.unbind(template, events, self.handleMouseWheel);\n            }\n          });\n          self.mouseZoomedIn = false;\n          var hasDraggingClass,\n            updateZoomable = function () {\n              if (self.mouseZoomedIn) {\n                framework.removeClass(template, 'pswp--zoomed-in');\n                self.mouseZoomedIn = false;\n              }\n              if (_currZoomLevel < 1) {\n                framework.addClass(template, 'pswp--zoom-allowed');\n              } else {\n                framework.removeClass(template, 'pswp--zoom-allowed');\n              }\n              removeDraggingClass();\n            },\n            removeDraggingClass = function () {\n              if (hasDraggingClass) {\n                framework.removeClass(template, 'pswp--dragging');\n                hasDraggingClass = false;\n              }\n            };\n          _listen('resize', updateZoomable);\n          _listen('afterChange', updateZoomable);\n          _listen('pointerDown', function () {\n            if (self.mouseZoomedIn) {\n              hasDraggingClass = true;\n              framework.addClass(template, 'pswp--dragging');\n            }\n          });\n          _listen('pointerUp', removeDraggingClass);\n          if (!onInit) {\n            updateZoomable();\n          }\n        },\n        handleMouseWheel: function (e) {\n          if (_currZoomLevel <= self.currItem.fitRatio) {\n            if (_options.modal) {\n              if (!_options.closeOnScroll || _numAnimations || _isDragging) {\n                e.preventDefault();\n              } else if (_transformKey && Math.abs(e.deltaY) > 2) {\n                // close PhotoSwipe\n                // if browser supports transforms & scroll changed enough\n                _closedByScroll = true;\n                self.close();\n              }\n            }\n            return true;\n          }\n\n          // allow just one event to fire\n          e.stopPropagation();\n\n          // https://developer.mozilla.org/en-US/docs/Web/Events/wheel\n          _wheelDelta.x = 0;\n          if ('deltaX' in e) {\n            if (e.deltaMode === 1 /* DOM_DELTA_LINE */) {\n              // 18 - average line height\n              _wheelDelta.x = e.deltaX * 18;\n              _wheelDelta.y = e.deltaY * 18;\n            } else {\n              _wheelDelta.x = e.deltaX;\n              _wheelDelta.y = e.deltaY;\n            }\n          } else if ('wheelDelta' in e) {\n            if (e.wheelDeltaX) {\n              _wheelDelta.x = -0.16 * e.wheelDeltaX;\n            }\n            if (e.wheelDeltaY) {\n              _wheelDelta.y = -0.16 * e.wheelDeltaY;\n            } else {\n              _wheelDelta.y = -0.16 * e.wheelDelta;\n            }\n          } else if ('detail' in e) {\n            _wheelDelta.y = e.detail;\n          } else {\n            return;\n          }\n          _calculatePanBounds(_currZoomLevel, true);\n          var newPanX = _panOffset.x - _wheelDelta.x,\n            newPanY = _panOffset.y - _wheelDelta.y;\n\n          // only prevent scrolling in nonmodal mode when not at edges\n          if (_options.modal || newPanX <= _currPanBounds.min.x && newPanX >= _currPanBounds.max.x && newPanY <= _currPanBounds.min.y && newPanY >= _currPanBounds.max.y) {\n            e.preventDefault();\n          }\n\n          // TODO: use rAF instead of mousewheel?\n          self.panTo(newPanX, newPanY);\n        },\n        toggleDesktopZoom: function (centerPoint) {\n          centerPoint = centerPoint || {\n            x: _viewportSize.x / 2 + _offset.x,\n            y: _viewportSize.y / 2 + _offset.y\n          };\n          var doubleTapZoomLevel = _options.getDoubleTapZoom(true, self.currItem);\n          var zoomOut = _currZoomLevel === doubleTapZoomLevel;\n          self.mouseZoomedIn = !zoomOut;\n          self.zoomTo(zoomOut ? self.currItem.initialZoomLevel : doubleTapZoomLevel, centerPoint, 333);\n          framework[(!zoomOut ? 'add' : 'remove') + 'Class'](template, 'pswp--zoomed-in');\n        }\n      }\n    });\n\n    /*>>desktop-zoom*/\n\n    /*>>history*/\n    /**\n     *\n     * history.js:\n     *\n     * - Back button to close gallery.\n     * \n     * - Unique URL for each slide: example.com/&pid=1&gid=3\n     *   (where PID is picture index, and GID and gallery index)\n     *   \n     * - Switch URL when slides change.\n     * \n     */\n\n    var _historyDefaultOptions = {\n      history: true,\n      galleryUID: 1\n    };\n    var _historyUpdateTimeout,\n      _hashChangeTimeout,\n      _hashAnimCheckTimeout,\n      _hashChangedByScript,\n      _hashChangedByHistory,\n      _hashReseted,\n      _initialHash,\n      _historyChanged,\n      _closedFromURL,\n      _urlChangedOnce,\n      _windowLoc,\n      _supportsPushState,\n      _getHash = function () {\n        return _windowLoc.hash.substring(1);\n      },\n      _cleanHistoryTimeouts = function () {\n        if (_historyUpdateTimeout) {\n          clearTimeout(_historyUpdateTimeout);\n        }\n        if (_hashAnimCheckTimeout) {\n          clearTimeout(_hashAnimCheckTimeout);\n        }\n      },\n      // pid - Picture index\n      // gid - Gallery index\n      _parseItemIndexFromURL = function () {\n        var hash = _getHash(),\n          params = {};\n        if (hash.length < 5) {\n          // pid=1\n          return params;\n        }\n        var i,\n          vars = hash.split('&');\n        for (i = 0; i < vars.length; i++) {\n          if (!vars[i]) {\n            continue;\n          }\n          var pair = vars[i].split('=');\n          if (pair.length < 2) {\n            continue;\n          }\n          params[pair[0]] = pair[1];\n        }\n        if (_options.galleryPIDs) {\n          // detect custom pid in hash and search for it among the items collection\n          var searchfor = params.pid;\n          params.pid = 0; // if custom pid cannot be found, fallback to the first item\n          for (i = 0; i < _items.length; i++) {\n            if (_items[i].pid === searchfor) {\n              params.pid = i;\n              break;\n            }\n          }\n        } else {\n          params.pid = parseInt(params.pid, 10) - 1;\n        }\n        if (params.pid < 0) {\n          params.pid = 0;\n        }\n        return params;\n      },\n      _updateHash = function () {\n        if (_hashAnimCheckTimeout) {\n          clearTimeout(_hashAnimCheckTimeout);\n        }\n        if (_numAnimations || _isDragging) {\n          // changing browser URL forces layout/paint in some browsers, which causes noticable lag during animation\n          // that's why we update hash only when no animations running\n          _hashAnimCheckTimeout = setTimeout(_updateHash, 500);\n          return;\n        }\n        if (_hashChangedByScript) {\n          clearTimeout(_hashChangeTimeout);\n        } else {\n          _hashChangedByScript = true;\n        }\n        var pid = _currentItemIndex + 1;\n        var item = _getItemAt(_currentItemIndex);\n        if (item.hasOwnProperty('pid')) {\n          // carry forward any custom pid assigned to the item\n          pid = item.pid;\n        }\n        var newHash = _initialHash + '&' + 'gid=' + _options.galleryUID + '&' + 'pid=' + pid;\n        if (!_historyChanged) {\n          if (_windowLoc.hash.indexOf(newHash) === -1) {\n            _urlChangedOnce = true;\n          }\n          // first time - add new hisory record, then just replace\n        }\n        var newURL = _windowLoc.href.split('#')[0] + '#' + newHash;\n        if (_supportsPushState) {\n          if ('#' + newHash !== window.location.hash) {\n            history[_historyChanged ? 'replaceState' : 'pushState']('', document.title, newURL);\n          }\n        } else {\n          if (_historyChanged) {\n            _windowLoc.replace(newURL);\n          } else {\n            _windowLoc.hash = newHash;\n          }\n        }\n        _historyChanged = true;\n        _hashChangeTimeout = setTimeout(function () {\n          _hashChangedByScript = false;\n        }, 60);\n      };\n    _registerModule('History', {\n      publicMethods: {\n        initHistory: function () {\n          framework.extend(_options, _historyDefaultOptions, true);\n          if (!_options.history) {\n            return;\n          }\n          _windowLoc = window.location;\n          _urlChangedOnce = false;\n          _closedFromURL = false;\n          _historyChanged = false;\n          _initialHash = _getHash();\n          _supportsPushState = 'pushState' in history;\n          if (_initialHash.indexOf('gid=') > -1) {\n            _initialHash = _initialHash.split('&gid=')[0];\n            _initialHash = _initialHash.split('?gid=')[0];\n          }\n          _listen('afterChange', self.updateURL);\n          _listen('unbindEvents', function () {\n            framework.unbind(window, 'hashchange', self.onHashChange);\n          });\n          var returnToOriginal = function () {\n            _hashReseted = true;\n            if (!_closedFromURL) {\n              if (_urlChangedOnce) {\n                history.back();\n              } else {\n                if (_initialHash) {\n                  _windowLoc.hash = _initialHash;\n                } else {\n                  if (_supportsPushState) {\n                    // remove hash from url without refreshing it or scrolling to top\n                    history.pushState('', document.title, _windowLoc.pathname + _windowLoc.search);\n                  } else {\n                    _windowLoc.hash = '';\n                  }\n                }\n              }\n            }\n            _cleanHistoryTimeouts();\n          };\n          _listen('unbindEvents', function () {\n            if (_closedByScroll) {\n              // if PhotoSwipe is closed by scroll, we go \"back\" before the closing animation starts\n              // this is done to keep the scroll position\n              returnToOriginal();\n            }\n          });\n          _listen('destroy', function () {\n            if (!_hashReseted) {\n              returnToOriginal();\n            }\n          });\n          _listen('firstUpdate', function () {\n            _currentItemIndex = _parseItemIndexFromURL().pid;\n          });\n          var index = _initialHash.indexOf('pid=');\n          if (index > -1) {\n            _initialHash = _initialHash.substring(0, index);\n            if (_initialHash.slice(-1) === '&') {\n              _initialHash = _initialHash.slice(0, -1);\n            }\n          }\n          setTimeout(function () {\n            if (_isOpen) {\n              // hasn't destroyed yet\n              framework.bind(window, 'hashchange', self.onHashChange);\n            }\n          }, 40);\n        },\n        onHashChange: function () {\n          if (_getHash() === _initialHash) {\n            _closedFromURL = true;\n            self.close();\n            return;\n          }\n          if (!_hashChangedByScript) {\n            _hashChangedByHistory = true;\n            self.goTo(_parseItemIndexFromURL().pid);\n            _hashChangedByHistory = false;\n          }\n        },\n        updateURL: function () {\n          // Delay the update of URL, to avoid lag during transition, \n          // and to not to trigger actions like \"refresh page sound\" or \"blinking favicon\" to often\n\n          _cleanHistoryTimeouts();\n          if (_hashChangedByHistory) {\n            return;\n          }\n          if (!_historyChanged) {\n            _updateHash(); // first time\n          } else {\n            _historyUpdateTimeout = setTimeout(_updateHash, 800);\n          }\n        }\n      }\n    });\n\n    /*>>history*/\n    framework.extend(self, publicMethods);\n  };\n  return PhotoSwipe;\n});"],"sourceRoot":""}